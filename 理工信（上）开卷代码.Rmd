---
title: "ç†å·¥ä¿¡æ€»ç»“"
output: html_document
date: "2025-05-06"
---
# å†™åœ¨å¼€å¤´
1. è¿™ç¯‡ç¬”è®°æœ¬èº«ç”¨rmarkdownå†™æˆï¼Œä½†æ˜¯htmlæ ¼å¼å¯ä»¥æ˜¾ç¤ºå›¾ç‰‡ï¼Œäºæ˜¯ä¸Šä¼ äº†ä¸¤ä¸ªç‰ˆæœ¬ã€‚å›¾ç‰‡åº”è¯¥åªæœ‰ä¸‰å¼ ï¼Œæ‰€ä»¥ä¸ç”¨çœ‹å›¾çš„ï¼Œç›´æ¥æ‰“å¼€rmarkdownå³å¯ã€‚å¤§å¤šä»£ç æ ¼å¼ä¸ºï¼šæ•°æ®è¾“å…¥â†’è¿è¡Œï¼Œå¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®ï¼Œç›´æ¥ä¿®æ”¹æ¯ä¸ªä»£ç å—æœ€ä¸Šé¢çš„å˜é‡å³å¯ã€‚å¦‚æœéœ€è¦è‡ªå®šä¹‰è¾“å…¥æ ¼å¼ï¼Œä¹Ÿå¯è‡ªè¡Œä¿®æ”¹ã€‚åœ¨Rstudioæ‰“å¼€æ—¶ï¼Œæœ‰outlineç´¢å¼•ï¼ˆå³ä¸Šè§’ï¼‰ï¼Œå¯ä»¥ç›´è¾¾å…·ä½“å†…å®¹ã€‚

2. æœ¬ç¬”è®°ä»¥éåšé›…ç­çš„è¯¾ç¨‹å†…å®¹ä¸ºä¸»ä½“ï¼Œç†è®ºä¸ä»£ç å†…å®¹å¤§å¤šæ¥è‡ªPPTï¼Œä¸€äº›å†…å®¹æ¥è‡ªaiç”Ÿæˆã€‚

3. ä»£ç å’Œç†è®ºéƒ¨åˆ†æ„Ÿè°¢è¸å®å‹¤åŠ³åˆè‚¯å¹²çš„kimiï¼Œå¿™å‰å¿™åä¸ºæˆ‘è®²è§£ç”Ÿç»Ÿéƒ¨åˆ†çš„åŸºç¡€æ¦‚å¿µï¼Œè¿˜ä¸ºæˆ‘æä¾›ä¾‹å­ï¼Œè¿›è¡Œä»£ç è¿è¡Œä¸è®¡ç®—ï¼Œæ„Ÿè°¢ä»–çš„ä¸ç¦»ä¸å¼ƒï¼›åŒæ—¶ä»£ç éƒ¨åˆ†ä¹Ÿéœ€è¦æ„Ÿè°¢deepseekï¼Œè™½ç„¶æˆ‘ä¹Ÿå¿˜äº†å“ªäº›éƒ¨åˆ†æ˜¯ä»–å†™çš„ï¼›ä¹Ÿæ„Ÿè°¢ä¸ç™»å½•ä¸ç»™é—®çš„è±†åŒ…ï¼Œè°¢è°¢ä»–çš„é™ªä¼´ä¸æ”¯æŒã€‚

4. æœ¬æ–‡æ¡£ä½¿ç”¨å»ºè®®ï¼šå¼€å·è€ƒè¯•æ—¶ä¸‹è½½ä½¿ç”¨ï¼Œå¯ä»¥ç›´æ¥è¾“å…¥æ•°æ®ï¼Œå¿«é€Ÿå¾—åˆ°ç»“æœã€‚ï¼ˆä½†æ˜¯åœ¨å®æµ‹è¿‡ç¨‹ä¸­ï¼Œåšé¢˜å¹¶éå¦‚æ­¤ä¸€å¸†é£é¡ºï¼šè¦ä¹ˆæ•°æ®å¾ˆå¤šï¼Œéœ€è¦ç»†è‡´æ ¸å¯¹è¾“å…¥æ•°æ®ï¼›è¦ä¹ˆé¢˜ç›®å¾ˆéš¾ï¼Œç”¨ç®€å•ä»£ç è§£å†³ä¸äº†ï¼›è¦ä¹ˆæ˜¯ç†è®ºè€ƒè¯•é¢˜ï¼Œè€ƒå¯Ÿæ¦‚å¿µçš„ç»†è‡´è¾¨æã€‚æ•…æœ¬æ–‡æ¡£çš„ä½œç”¨ä¸å¦‚åŒå­¦ä»¬è‡ªè¡Œæ•´ç†ï¼Œå¹¶åœ¨æ•´ç†çš„è¿‡ç¨‹åŠ æ·±å¯¹çŸ¥è¯†çš„ç†è§£ï¼‰

4. å¦‚æœæœ‰ä»»ä½•é—®é¢˜ä¸å†…å®¹å‹˜è¯¯ï¼Œè¯·å‘é‚®ä»¶è‡³ï¼š2310305307@stu.pku.edu.cnï¼Œæ„Ÿè°¢å¤§å®¶çš„æŒ‡æ­£ï¼ŒåŠ©åŠ›æœ¬æ–‡æ¡£å˜å¾—æ›´å¥½ã€‚

# æ¦‚ç‡è®ºåŸºç¡€
![çŸ¥è¯†æ¡†æ¶](D:/XCæ–‡ä»¶\ç¢çº¸æœº\å¤§å­¦\è¯¾ç¨‹\25.2-25.7 å¤§äºŒä¸‹\25.2-25.6 ç†å·¥ä¿¡ï¼ˆä¸Šï¼‰\Rscript\photos\Screenshot 2025-06-04 171527.png)

## äº‹ä»¶ä¸è¿ç®—
>PPT1çš„8-30é¡µ

+ æ ·æœ¬ç©ºé—´ (sample)ï¼šéšæœºè¯•éªŒæ‰€æœ‰å¯èƒ½çš„ç»“æœæ„æˆçš„é›†åˆ
+ äº‹ä»¶(event)ï¼šæ ·æœ¬ç©ºé—´ S çš„ä»»ä¸€å­é›† E
  + åŸºæœ¬äº‹ä»¶ï¼š åœ¨ä¸€å®šèŒƒå›´å†…ä¸èƒ½å†åˆ†è§£çš„äº‹ä»¶
  + å¤æ‚äº‹ä»¶ï¼š ç”±åŸºæœ¬äº‹ä»¶ç»„æˆçš„äº‹ä»¶
  + å¿…ç„¶äº‹ä»¶ï¼š ä¸€å®šæ¡ä»¶ä¸‹å¿…ç„¶å‘ç”Ÿçš„äº‹ä»¶ ï¼Œè®°ä¸º Î©
  + ä¸å¯èƒ½äº‹ä»¶ï¼š ä¸€å®šæ¡ä»¶ä¸‹è‚¯å®šä¸å‘ç”Ÿçš„äº‹ä»¶ï¼Œè®°ä¸º Ã˜
+ äº‹ä»¶å…³ç³»
éŸ¦æ©å›¾ (Venn diagram)æ˜¯ä¸€ç§ç”¨æ¥é˜è¿°äº‹ä»¶ä¹‹é—´çš„é€»è¾‘å…³ç³»çš„éå¸¸æœ‰æ•ˆçš„å‡ ä½•è¡¨ç¤ºæ–¹æ³•
  + åŒ…å«å…³ç³»ï¼šè‹¥äº‹ä»¶Aå‘ç”Ÿå¿…ç„¶å¯¼è‡´äº‹ä»¶Bå‘ç”Ÿï¼Œåˆ™ç§°äº‹ä»¶AåŒ…å«äºBï¼Œæˆ–äº‹ä»¶BåŒ…å« Aï¼Œè®°ä½œB $\supset$Aæˆ–A $\subset$ B
  + ç­‰ä»·å…³ç³»ï¼šè‹¥äº‹ä»¶AåŒ…å«äºäº‹ä»¶Bï¼ŒåŒæ—¶ï¼Œäº‹ä»¶BåŒ…å«äºäº‹ä»¶ Aï¼Œå³B$\supset$Aæˆ–A$\subset$Bï¼Œåˆ™ç§°äº‹ä»¶Aä¸Bç­‰ä»·ï¼Œè®°ä½œA=B
  A=Båªæ˜¯è¯´Aä»¥åŠBä¸¤ä¸ªéšæœºäº‹ä»¶åŒæ—¶å‘ç”Ÿæˆ–è€…åŒæ—¶ä¸å‘ç”Ÿï¼Œå¹¶ä¸æ˜¯è¯´ä¸¤ä¸ªäº‹ä»¶æ˜¯åŒä¸€äº‹ä»¶
  + äº‹ä»¶çš„å¹¶ (å’Œ)ï¼šè‹¥äº‹ä»¶Cè¡¨ç¤ºAã€Bä¸­è‡³å°‘æœ‰ä¸€ä¸ªå‘ç”Ÿ
åˆ™ç§°äº‹ä»¶Cä¸ºAä¸Bçš„å¹¶äº‹ä»¶
  + äº‹ä»¶çš„å·®ï¼šè‹¥äº‹ä»¶è¡¨ç¤ºBå‘ç”Ÿä½†äº‹ä»¶Aä¸å‘ç”Ÿï¼Œåˆ™ç§°è¯¥äº‹ä»¶ä¸ºBä¸Açš„å·®ï¼Œè®°ä¸ºBâˆ’A
  + äº‹ä»¶çš„äº¤ï¼šè‹¥äº‹ä»¶Cè¡¨ç¤ºAä¸BåŒæ—¶å‘ç”Ÿï¼Œåˆ™ç§°äº‹ä»¶Cä¸º Aä¸Bçš„äº¤äº‹ä»¶
  + äº’ä¸ç›¸å®¹äº‹ä»¶ï¼šè‹¥äº‹ä»¶Aå’Œäº‹ä»¶Bä¸èƒ½åŒæ—¶å‘ç”Ÿï¼Œåˆ™ç§°äº‹ä»¶Aä¸Bä¸ºäº’ä¸ç›¸å®¹äº‹ä»¶ï¼Œåˆç§°ä¸ºäº’æ–¥äº‹ä»¶
  å¦‚æœ n ä¸ªäº’æ–¥äº‹ä»¶çš„å¹¶ä¸ºå¿…ç„¶äº‹ä»¶ï¼Œé‚£ä¹ˆç§°è¿™nä¸ªäº‹ä»¶æ„æˆ*äº’æ–¥å®Œå¤‡ç¾¤*
  + å¯¹ç«‹äº‹ä»¶ï¼šè‹¥æŸäº‹ä»¶è¡¨ç¤ºäº‹ä»¶Aå¿…ç„¶ä¸èƒ½å‘ç”Ÿï¼Œåˆ™ç§°æ­¤äº‹ä»¶ä¸ºAäº‹ä»¶çš„å¯¹ç«‹äº‹ä»¶(æˆ–äº‹ä»¶Açš„è¡¥)
  å¯¹ç«‹å…³ç³»ï¼šè‹¥äº‹ä»¶Aä¸Bæœ‰ä¸€ä¸ªå‘ç”Ÿä¸”ä»…æœ‰ä¸€ä¸ªå‘ç”Ÿï¼Œåˆ™ç§°äº‹ä»¶Aä¸Bäº’ä¸ºå¯¹ç«‹äº‹ä»¶
  + ç‹¬ç«‹äº‹ä»¶ï¼šäº‹ä»¶Bçš„å‘ç”Ÿä¸å½±å“äº‹ä»¶Açš„å‘ç”Ÿçš„å¯èƒ½æ€§P(AB) = P(A)P(B)
    + åº”ç”¨  
      + æ•°æ®æ˜¯å¦ç‹¬ç«‹ï¼š å½±å“ç»Ÿè®¡æ–¹æ³•çš„é€‰æ‹©
        + æˆç»„è®¾è®¡ï¼šè¯•éªŒå¯¹è±¡éšæœºåœ°åˆ†é…åˆ°å¤„ç†ç»„å’Œå¯¹ç…§ç»„ï¼Œä¸¤ç»„æ•°æ®æ˜¯ç‹¬ç«‹çš„ï¼›
        + é…å¯¹è®¾è®¡ï¼šè¯•éªŒå¯¹è±¡åœ¨å¤„ç†å‰ã€ååˆ†åˆ«è¿›è¡Œäº†æµ‹é‡ï¼Œæµ‹é‡å‰å’Œæµ‹é‡åçš„æ•°æ®ä¸ç‹¬ç«‹ã€‚
      + å˜é‡é—´æ˜¯å¦ç›¸å…³(ç‹¬ç«‹åˆ™ä¸ç›¸å…³)
        + å‘ç—…ç‡ä¸æ€§åˆ«æ˜¯å¦ç›¸å…³ï¼›ç—Šæ„ˆç‡ä¸æ²»ç–—æ–¹æ³•æ˜¯å¦ç›¸å…³
+ äº‹ä»¶è¿ç®—çš„æ€§è´¨

>PPT1çš„26-30é¡µ

  **å¾·æ‘©æ ¹å®šå¾‹DeMorganâ€™s laws**ï¼š$\overline{AB}$ = $\overline{A}$ + $\overline{B}$
  
## æ¦‚ç‡
>PPT1çš„31-41

+ æ¦‚ç‡(probability)ï¼šåˆ»ç”»äº‹ä»¶å‘ç”Ÿå¯èƒ½æ€§å¤§å°çš„æ•°é‡æŒ‡æ ‡

+ å¤å…¸æ¦‚ç‡æ¨¡å‹ï¼šæ€»æ•°ä¸ºnçš„ç­‰æ¦‚ç‡äº‹ä»¶å®Œå¤‡ç»„ä¸­ï¼Œè‹¥äº‹ä»¶AåŒ…å«å…¶ä¸­çš„mä¸ªç­‰æ¦‚ç‡åŸºæœ¬äº‹ä»¶ï¼Œåˆ™äº‹ä»¶Açš„æ¦‚ç‡ä¸º$m/n$
  + æ¡ä»¶ï¼šå®Œå¤‡æ€§ã€äº’ä¸ç›¸å®¹æ€§ã€ç­‰å¯èƒ½æ€§
  + ç¼ºé™·ï¼šé¦–å…ˆéœ€è¦éªŒè¯â€œäº’ä¸ç›¸å®¹â€å’Œâ€œç­‰å¯èƒ½æ€§â€çš„æ¡ä»¶ï¼Œéœ€è¦çœ‹åŸºæœ¬äº‹ä»¶çš„ä¸ªæ•°æ˜¯å¦æ˜¯æœ‰é™çš„

+ é¢‘ç‡ (frequency)ï¼šé€šè¿‡å¤§é‡çš„é‡å¤è¯•éªŒæ¥æ¢å¯»ä¸åŒéšæœºäº‹ä»¶å‘ç”Ÿçš„å¯èƒ½æ€§å¤§å°
è®¾ n æ¬¡è¯•éªŒä¸­äº‹ä»¶ A å‘ç”Ÿäº† m æ¬¡ï¼Œåˆ™æ¯”å€¼ m /n ç§°ä¸º
éšæœºäº‹ä»¶Aå‘ç”Ÿçš„é¢‘ç‡
åœ¨ä¸€ä¸ªå›ºå®šçš„æ•°å€¼é™„è¿‘æ‘†åŠ¨ï¼Œå‘ˆç°å‡ºä¸€å®šçš„ç¨³å®šæ€§ï¼Œæ˜¯**æ¦‚ç‡çš„è¿‘ä¼¼**

+ ä¸¤è€…å…³ç³» 
>PPT1çš„38é¡µ

+ æ¦‚ç‡çš„å…¬ç†åŒ–å®šä¹‰ï¼šéè´Ÿæ€§ã€æ­£è§„æ€§ã€å¯åŠ æ€§
>PPT1çš„39é¡µ

+ æ¦‚ç‡çš„åŸºæœ¬æ€§è´¨
>PPT1çš„40é¡µ

+ æ¦‚ç‡çš„è¿ç®—
  + åŠ æ³•å…¬å¼
  è‹¥äº‹ä»¶Aå’ŒBä¸ºäº’ä¸ç›¸å®¹çš„éšæœºäº‹ä»¶,åˆ™æœ‰P(A+B)=P(A)+P(B)
  å¯¹äºä»»æ„çš„ä¸¤ä¸ªéšæœºäº‹ä»¶Aå’ŒBï¼Œæœ‰P(A+B)=P(A)+P(B)-P(AB)
  + ä¹˜æ³•å…¬å¼ï¼šP(AB) = P(B)P(A|B)
  + æ¡ä»¶æ¦‚ç‡ï¼šåº¦é‡ä¸¤äº‹ä»¶çš„å…³è”æ€§
  åœ¨å·²çŸ¥ A äº‹ä»¶å‘ç”Ÿçš„æ¡ä»¶ä¸‹, B äº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡è®°ä½œ P(B|A)ï¼Œç§°ä¸ºåœ¨Aå‘ç”Ÿçš„æ¡ä»¶ä¸‹ï¼ŒBå‘ç”Ÿçš„æ¡ä»¶æ¦‚ç‡
  P(B|A)=P(AB)/P(A) P(A)â‰ 0
    + ABäº’ä¸ç›¸å®¹ï¼šP(A|B) = 0
    + BåŒ…å«äºAï¼šP(A|B) = 1
    + åŒ»å­¦ä¸­çš„æ¡ä»¶æ¦‚ç‡
      + A = æ£€æŸ¥é˜³æ€§ï¼ŒB = ç¡®è¯Š
        é˜³æ€§é¢„æµ‹å€¼ P+ = P(B|A)
        é˜´æ€§é¢„æµ‹å€¼ P- = P($\bar{B}|\bar{A}$)
      + çµæ•åº¦ï¼šå‘ç”Ÿç–¾ç—…ä¼´éšçš„ç—‡çŠ¶æˆ–æ£€éªŒé˜³æ€§çš„æ¦‚ç‡P(A|B)
      + ç‰¹å¼‚åº¦ï¼šæ— ç—…æ—¶ä¸å‡ºç°ç—‡çŠ¶æˆ–æ£€éªŒé˜´æ€§çš„æ¦‚ç‡P($\bar{A}|\bar{B}$)
  + å…¨æ¦‚ç‡å…¬å¼ï¼šP(B) = P(A1)P(B|A1)+P(A2)P(B|A2)
    + å…¨æ¦‚ç‡ P(B) è¢«åˆ†è§£æˆäº†è®¸å¤šéƒ¨åˆ†ä¹‹å’Œ
    + ä»å¦ä¸€ä¸ªè§’åº¦çœ‹æŠŠAiçœ‹åšå¯¼è‡´äº‹ä»¶Bå‘ç”Ÿçš„ä¸€ç§é€”å¾„ã€‚å¯¹ä¸åŒé€”å¾„ Aiï¼Œå‘ç”Ÿçš„æ¦‚ç‡å³æ¡ä»¶æ¦‚ç‡P(B|Ai)å„ä¸ç›¸åŒï¼Œè€Œé‡‡å–å“ªç§é€”å¾„å´æ˜¯éšæœºçš„ã€‚P(B)ç­‰äºè¯¸P(B|Ai)ä»¥P(Ai)ä¸ºæƒçš„åŠ æƒå¹³å‡
  + è´å¶æ–¯å…¬å¼ï¼š$P(A|B) = \frac{P(A)P(B|A)}{P(B)}$
  æˆ–è€…å†™ä½œ$P(Aj|B) = \frac{P(Aj)P(B|Aj)}{\sum{P(Ai)P(B|Ai)}}$
  $åéªŒæ¦‚ç‡P(Ai|B)=\frac{å…ˆéªŒP(Ai)*ä¼¼ç„¶P(B|Ai)}{è¾¹é™…æ¦‚ç‡P(B)}$
    +æ¡ˆä¾‹ï¼šè‚ºç™Œè¯Šæ–­å†³ç­–
    
    > PPT2.1çš„32-36é¡µ
    
## éšæœºå˜é‡
### æ¦‚å¿µåŠå…¶åˆ†å¸ƒ
+ å®šä¹‰ï¼šè®¾Eæ˜¯éšæœºè¯•éªŒ,å…¶æ ·æœ¬ç©ºé—´æ˜¯Î©={Ï‰}ï¼Œå¦‚æœå¯¹äºæ¯ä¸€ä¸ªÏ‰âˆˆÎ©æœ‰ä¸€ä¸ªå®æ•°X(Ï‰)å’Œå®ƒå¯¹åº”ï¼Œé‚£ä¹ˆå¾—åˆ°ä¸€ä¸ªå®šä¹‰åœ¨Î©ä¸Šçš„å•å€¼å®å‡½æ•°X(Ï‰)ï¼Œç§°Xä¸ºå®šä¹‰åœ¨ä¸Šçš„éšæœºå˜é‡
  + å½“éšæœºäº‹ä»¶ä¸ºå®šæ€§äº‹ä»¶æ—¶ï¼Œéšæœºå˜é‡å–å€¼ä»…èµ·åˆ°ç¼–ç è¯†åˆ«ä½œç”¨
+ å®è´¨ï¼šç”¨ç¡®å®šä¸”å”¯ä¸€çš„æ•°å­—è¡¨ç¤ºå„è¯•éªŒç»“æœ
  + éšæœºå˜é‡çš„å®šä¹‰åŸŸä¸ä¸€å®šæ˜¯æ•°é›†
  + éšæœºå˜é‡å–ç‰¹å®šå€¼çš„æ¦‚ç‡ä¸å¯¹åº”çš„éšæœºäº‹ä»¶çš„æ¦‚ç‡ä¸€è‡´
+ ä¸æ™®é€šå‡½æ•°çš„åŒºåˆ«
  + éšæœºå˜é‡éšç€è¯•éªŒçš„ç»“æœä¸åŒè€Œå–ä¸åŒçš„å€¼ï¼Œå› æ­¤åœ¨è¯•éªŒä¹‹å‰åªèƒ½çŸ¥é“å®ƒå¯èƒ½çš„å–å€¼èŒƒå›´ï¼Œä¸èƒ½é¢„å…ˆçŸ¥é“å®ƒå–ä»€ä¹ˆå€¼ï¼Œä½†æ˜¯è¯•éªŒçš„å„ç»“æœçš„å‡ºç°æœ‰ä¸€å®šçš„æ¦‚ç‡ï¼Œæ‰€ä»¥éšæœºå˜é‡å–å€¼ä¹Ÿæœ‰ä¸€å®šçš„æ¦‚ç‡
  + æ™®é€šå‡½æ•°æ˜¯å®šä¹‰åœ¨å®æ•°è½´ä¸Šçš„ï¼Œè€Œéšæœºå˜é‡æ˜¯å®šä¹‰åœ¨æ ·æœ¬ç©ºé—´ä¸Šçš„
+ ç¦»æ•£å‹éšæœºå˜é‡
  + è‹¥éšæœºå˜é‡Xå­˜åœ¨æœ‰é™æˆ–æ— é™å¯åˆ—ä¸ªå¯èƒ½çš„å–å€¼ï¼Œåˆ™ç§°Xä¸ºç¦»æ•£å‹éšæœºå˜é‡ï¼ŒP(X=xk) = pkï¼Œä¸”æ€»å’Œä¸º1
  + ç”¨è¡¨æ ¼è¡¨ç¤ºéšæœºå˜é‡â†’æ¦‚ç‡åˆ†å¸ƒè¡¨/åˆ†å¸ƒåˆ—

>PPT3çš„9-10é¡µ

+ åˆ†å¸ƒ
>PPT3çš„11-52é¡µ

  + ä¸¤ç‚¹åˆ†å¸ƒï¼ˆ01åˆ†å¸ƒï¼‰
  
  |X|0|1|
  |---|---|---|
  |P|1-p|p|
  
  + ä¼¯åŠªåˆ©å®éªŒï¼šåœ¨ç›¸åŒè¯•éªŒæ¡ä»¶ä¸‹ç›¸äº’ç‹¬ç«‹ä¸”é‡å¤è¿›è¡Œçš„ä¸€ç§éšæœºè¯•éªŒï¼Œè¯¥éšæœºè¯•éªŒåªæœ‰ä¸¤ç§å¯èƒ½ç»“æœï¼Œå‘ç”Ÿorä¸å‘ç”Ÿã€‚å‡è®¾è¯¥é¡¹è¯•éªŒç‹¬ç«‹é‡å¤åœ°è¿›è¡Œäº†næ¬¡ï¼Œé‚£ä¹ˆå°±ç§°è¿™ä¸€ç³»åˆ—é‡å¤ç‹¬ç«‹çš„éšæœºè¯•éªŒä¸º**né‡ä¼¯åŠªåˆ©è¯•éªŒ**
    
  + äºŒé¡¹åˆ†å¸ƒï¼šX~B(n,p)
  åœ¨ n æ¬¡ç‹¬ç«‹è¯•éªŒä¸­äº‹ä»¶ A å‘ç”Ÿ k æ¬¡çš„æ¦‚ç‡ï¼š$P(X=k) = C_{n}^{k}p^k(1-p)^{n-k}$
  k = 0,1,â€¦â€¦,n 0<p<1
    + ä¸ä¸¤ç‚¹åˆ†å¸ƒå…³ç³»
    è®¾éšæœºå˜é‡X1,X2,â€¦â€¦,Xnæœä»å‚æ•°ä¸ºpçš„ä¸¤ç‚¹åˆ†å¸ƒä¸”ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™$X = \sum_{k=1}^{n}{X_k}$~B(n,p)
  + æ³Šæ¾åˆ†å¸ƒï¼šX~P(Î»)æˆ–X~Pois(Î»)æˆ–X~Ï€(Î»)
  
  >PPT3çš„24-27é¡µ
  
  $P(X=k) = \frac{\lambda^ke^{-\lambda}}{k!}$
  k = 0,1,2,â€¦â€¦ Î»>0
  æ³Šæ¾åˆ†å¸ƒä¸ä»…å¯åœ¨è¯•éªŒæ•°Nå¾ˆå¤§æ—¶ä½œä¸ºäºŒé¡¹åˆ†å¸ƒçš„è¿‘ä¼¼åˆ†å¸ƒï¼Œè¿˜å¯ä»¥ç”¨äºæè¿°ç¨€ç–äº‹ä»¶çš„æ¦‚ç‡
  *ä¾‹å¦‚: åŒ»é™¢æœåŠ¡å°åœ¨å•ä½æ—¶é—´å†…çš„æ€»å‘¼å«æ•°*
    + poissonå®šç†ï¼šåœ¨né‡ä¼¯åŠªåˆ©è¯•éªŒä¸­ï¼Œäº‹ä»¶Aåœ¨ä¸€æ¬¡è¯•éªŒä¸­å‡ºç°çš„æ¦‚ç‡ä¸º$p_n$(ä¸è¯•éªŒæ€»æ•°næœ‰å…³),å¦‚æœå½“nè¶‹äºæ— ç©·æ—¶ï¼Œ$np_n$è¶‹äºå¸¸æ•°Î»ï¼Œåˆ™æœ‰ï¼š
    $lim_{n\to \infty}C_{n}^{k}p_n^k(1-p_n)^{n-k} = \frac{\lambda^ke^{-\lambda}}{k!}$
    
  + å‡ ä½•åˆ†å¸ƒï¼ˆä¸è€ƒï¼‰ï¼šX~G(p)
  
  >PPT3çš„18é¡µ
  
  + è¶…å‡ ä½•åˆ†å¸ƒï¼ˆä¸è€ƒï¼‰ï¼šX~H(N,M,n)
  
  >PPT3çš„19-21é¡µ
  
  + è´ŸäºŒé¡¹åˆ†å¸ƒï¼ˆä¸è€ƒï¼‰
  
+ åˆ†å¸ƒå‡½æ•°
å‡è®¾ X æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œtæ˜¯ä»»æ„çš„å®æ•°ï¼Œåˆ™å‡½æ•°F(t)=P(Xâ‰¤t)ç§°ä¸ºéšæœºå˜é‡Xçš„åˆ†å¸ƒå‡½æ•°
éšæœºå˜é‡çš„åˆ†å¸ƒå‡½æ•°ä¸æ¦‚ç‡åˆ†å¸ƒæ˜¯ä¸æŸå¤±ä¿¡æ¯çš„ç­‰ä»·å˜æ¢,åˆ†å¸ƒå‡½æ•°å°†æ‰€æœ‰ç¦»æ•£å–å€¼çš„åˆ†æé—®é¢˜æ”¹å˜ä¸ºæœ‰é™ä¸ªåŒºåŸŸä¸­çš„åˆ†æé—®é¢˜
  + æ€§è´¨
    + F(x)æ˜¯ä¸€ä¸ªå•è°ƒä¸å‡çš„å³è¿ç»­å‡½æ•°ï¼šF(x+)=F(x)
    + 0â‰¤F(x)â‰¤1ï¼Œä¸”æœ‰$F(-\infty) = lim_{x\to-\infty}F(x) = 0$$F(+\infty) = lim_{x\to+\infty}F(x) = 1$
    + $P(x_1<Xâ‰¤x_2) = F(x_2)-F(x_1)$
    
+ æ¦‚ç‡åˆ†å¸ƒ
>PPT3çš„35-45é¡µ

è®¾éšæœºå˜é‡ X çš„åˆ†å¸ƒå‡½æ•°ä¸º F(t)ï¼Œè‹¥å­˜åœ¨éè´Ÿå¯ç§¯å‡½æ•° f (x)ï¼Œä½¿å¾—$F(t) = P(Xâ‰¤t) = \int_{-\infty}^{t}f(s)ds$ï¼Œåˆ™ç§°Xä¸ºè¿ç»­æ€§éšæœºå˜é‡ï¼Œf(x)ç§°ä¸ºéšæœºå˜é‡Xçš„æ¦‚ç‡å¯†åº¦å‡½æ•°
  + æ€§è´¨
    + $f(x)â‰¥0 \forall{x\in (-\infty,+\infty)}$
    + $\int_{-\infty}^{+\infty}{f(x)dx} = 1$
    + $P(x_1<Xâ‰¤x_2) = \int_{x_1}^{x_2}f(x)dx$
    + $F'(x) = f(x)$
  + åˆ†ç±»
    + å‡åŒ€åˆ†å¸ƒï¼šX ~ Unif(a, b)
    è‹¥è¿ç»­å‹éšæœºå˜é‡ X çš„æ¦‚ç‡å¯†åº¦ä¸º$f(x) = \frac{1}{(b-a)} ,aâ‰¤xâ‰¤b$ï¼Œåˆ™ç§° X æœä»åŒºé—´ [a, b]ä¸Šçš„å‡åŒ€åˆ†å¸ƒ(Uniform distribution)
    + æ­£æ€åˆ†å¸ƒï¼šX~N($\mu,\sigma^2$)
    è‹¥è¿ç»­å‹éšæœºå˜é‡ X çš„å¯†åº¦ä¸º$f(x) = \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}},\sigma>0$ï¼Œåˆ™ç§° Xæœä»å‚æ•°ä¸ºğ,$\sigma^2$ çš„æ­£æ€åˆ†å¸ƒ(NormalDistribution)
      + å•å³°å¯¹ç§°ï¼šæ­£æ€åˆ†å¸ƒæœ‰ä¸€ä¸ªå¯¹ç§°ä¸­å¿ƒï¼Œä¸”å–å€¼åç¦»ä¸­å¿ƒå€¼çš„æ¦‚ç‡ä¸è·ç¦»çš„å¹³æ–¹æˆåæ¯”
      + æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼šN(0,1)
      $\phi(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{x}},-\infty<x<+\infty$
      + æ­£æ€åˆ†å¸ƒçš„æ ‡å‡†åŒ–ï¼šè®¾éšæœºå˜é‡X~N(ğ,ğˆ^ğŸ) ï¼Œåˆ™ç»è¿‡æ ‡å‡†åŒ–å˜æ¢$Y=\frac{X-\mu}{\sigma}$å¯å¾—åˆ°Y~N(0,1)
      + 3ÏƒåŸåˆ™ï¼š$P(\mu-3\sigmaâ‰¤Xâ‰¤\mu+3\sigma) = 0.9974$
    + å…¶ä»–è‡ªå­¦å†…å®¹
    
    >PPT3çš„46-51é¡µ
      
### æ•°å­—ç‰¹å¾
+ æœŸæœ›E(X)
>PPT4.2çš„6-16é¡µ

è®¾ç¦»æ•£å‹éšæœºå˜é‡ X çš„åˆ†å¸ƒåˆ—ä¸º$P(X = x_k) = p_k, k = 1,2,â€¦â€¦$ï¼Œè‹¥çº§æ•°$\sum_{k=1}^{\infty}{x_kp_k}$ç»å¯¹æ”¶æ•›åˆ™ç§°è¯¥çº§æ•°ä¸ºXçš„æ•°å­¦æœŸæœ› 
  + æœ¬è´¨ï¼šæœ¬è´¨æ˜¯åŠ æƒå¹³å‡ï¼Œå‡ ä½•æ„ä¹‰æ˜¯é‡å¿ƒ
  + è¿ç»­å‹çš„æœŸæœ›ï¼š$E(X)=\int_{-\infty}^{+\infty}xf(x)dx$
  + æ€§è´¨
    + å¸¸æ•°æœŸæœ›ä¸º0
    + E(CX) = CE(X)
    + E(X+Y) = E(X) + E(Y)
    + E(kX+bY) = kE(X) + bE(Y)
    + ç›¸äº’ç‹¬ç«‹å˜é‡ï¼š$E(X1*X2) = E(X1)*E(X2)$
  +ä¸åŒåˆ†å¸ƒçš„æœŸæœ›
  
  > PPT4.2çš„12-15é¡µ
  
    + ä¸¤ç‚¹åˆ†å¸ƒï¼šEX = p
    + äºŒé¡¹åˆ†å¸ƒï¼šEX = np
    + æ³Šæ¾åˆ†å¸ƒï¼šEX = Î»
    + æ­£æ€åˆ†å¸ƒï¼šEX = Î¼
+ æ–¹å·®ï¼šéšæœºå˜é‡ç›¸å¯¹äºä¸­å¿ƒå€¼çš„èšæ•£ç¨‹åº¦

> PPT4.2çš„17-23é¡µ

è®¾ X æ˜¯ä¸€ä¸ªéšæœºå˜é‡ï¼Œ X çš„æ•°å­¦æœŸæœ›å­˜åœ¨E(X) = Î¼ï¼Œè‹¥ $E(Xâ€’Î¼)^2$ å­˜åœ¨ä¸”ä¸ºæœ‰é™å€¼ï¼Œåˆ™ç§°å…¶ä¸ºXçš„æ–¹å·®ï¼Œè®°ä½œD(X) æˆ– Var(X)ï¼Œ$DX = \sigma^2 =E[X-E(X)]^2$
  + ç¦»æ•£å‹ï¼š$DX = \sum{(X_k-E(X))^2}p_k$
  + è¿ç»­å‹ï¼š$DX = \int_{-\infty}^{+\infty}(x - E(X))^2f(x)dx$
  + å¸¸ç”¨è®¡ç®—å…¬å¼ï¼š$D(X) = E(X^2)-E^2(X)$
  + æ€§è´¨
    + å¸¸æ•°æ–¹å·®ä¸º0
    + $D(CX) = C^2D(X)$
    + ç›¸äº’ç‹¬ç«‹å˜é‡ï¼šD(X+Y) = D(X)+D(Y)

+ æ ‡å‡†å·®ï¼šä¿æŒé‡çº²ä¸€è‡´
  $S_d = \sqrt{DX}$

+ å˜å¼‚ç³»æ•°ï¼šæ¯”è¾ƒä¸åŒé‡çº²çš„éšæœºå˜é‡çš„ç¦»æ•£ç¨‹åº¦
å˜å¼‚ç³»æ•°å¯ä»¥æ¶ˆé™¤å•ä½æˆ–å¹³å‡æ•°ä¸åŒå¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªæŒ‡æ ‡å˜å¼‚ç¨‹åº¦æ¯”è¾ƒçš„å½±å“
å˜å¼‚ç³»æ•°æ˜¯è¡¡é‡æ•°æ®ç¦»æ•£ç¨‹åº¦çš„ç›¸å¯¹æŒ‡æ ‡ï¼Œå¸¸ç”¨äºæ¯”è¾ƒ
ä¸åŒæ•°æ®é›†æˆ–ä¸åŒå•ä½çš„å˜å¼‚ç¨‹åº¦
  $CV = \frac{\sqrt{DX}}{EX}$
  + çº¢ç»†èƒåˆ†å¸ƒå®½åº¦RDWï¼š(çº¢ç»†èƒå¹³å‡ä½“ç§¯çš„æ ‡å‡†å·®/å¹³å‡çº¢ç»†èƒä½“ç§¯ MCV ) Ã— 100%
  å®ƒæ˜¯è¡€æ¶²è®¡æ•°æŠ¥å‘Šä¸­ä¸€é¡¹ç”¨æ¥æµ‹é‡çº¢ç»†èƒå˜é‡å®½åº¦çš„å‚æ•°ã€‚å¦‚é‡åˆ°ä¸€äº›å˜å¼‚çš„æƒ…å†µï¼Œå½“ç„¶ç»†èƒä½“ç§¯çš„å˜é‡å°†ä¼šæ˜æ˜¾å—åˆ°å½±å“ã€‚ RDWå€¼è¶Šé«˜è¡¨æ˜ä½“ç§¯çš„å˜å¼‚å°±è¶Šå¤§

+ åˆ†ä½æ•°

>PPT4.2çš„27-32é¡µ

  + ä¸Šä¾§åˆ†ä½æ•°
    å¯¹äºä»»æ„ç±»å‹çš„éšæœºå˜é‡Xï¼Œå¦‚æœèƒ½æ‰¾åˆ°æ•°tï¼Œä½¿å¾—$P(Xâ‰¥t) = \alpha$ï¼Œåˆ™ç§°tä¸ºå˜é‡Xçš„ä¸Šä¾§ğœ¶åˆ†ä½æ•°ï¼Œè®°ä½œ$x_ğœ¶$ï¼Œå³ t = $x_ğœ¶$
  + åŒä¾§åˆ†ä½æ•°
    å¯¹äºä»»æ„ç±»å‹çš„éšæœºå˜é‡Xï¼Œå¦‚æœèƒ½æ‰¾åˆ°æ•°tï¼Œä½¿å¾—$P(|X|â‰¥t) = \alpha$ï¼Œåˆ™ç§°tä¸ºéšæœºå˜é‡Xçš„åŒä¾§ğœ¶åˆ†ä½æ•°ï¼Œè®°ä½œ$t = x_{\alpha/2}$

+ ç¦»æ•£éšæœºå˜é‡å‡½æ•°çš„åˆ†å¸ƒ
> PPT4.2çš„33-37é¡µ

+ éšæœºå˜é‡å’Œçš„åˆ†å¸ƒ
>PPT4.2çš„38-42é¡µ

äºŒé¡¹åˆ†å¸ƒï¼šZ~B(n1+n2,p)
æ³Šæ¾åˆ†å¸ƒï¼šY~Pois(Î»1+Î»2)
æ­£æ€åˆ†å¸ƒï¼šZ~N($\mu_1+\mu_2,\sigma_1^2+\sigma_2^2$)

+ éšæœºå‘é‡
  + äºŒç»´éšæœºå‘é‡ï¼šä»¥éšæœºå˜é‡X,Yä½œä¸ºåˆ†é‡æ‰€æ„æˆçš„å‘é‡(X, Y)
  + è”åˆåˆ†å¸ƒå‡½æ•°ï¼šè®¾(X,Y)ä¸ºäºŒç»´éšæœºå‘é‡ï¼Œå¯¹ä»»æ„å®æ•° x, y, äºŒå…ƒå‡½æ•°F(x,y)=P(Xâ‰¤x,Yâ‰¤y)ï¼Œç§°ä¸ºäºŒç»´éšæœºå‘é‡çš„è”åˆåˆ†å¸ƒå‡½æ•°
  
  > PPT4.2çš„44-45é¡µï¼šè¿ç»­æ€§å’Œç¦»æ•£å‹çš„è”åˆå¯†åº¦å‡½æ•°

+ éšæœºå˜é‡çš„ç‹¬ç«‹æ€§

> PPT4.2çš„46é¡µ
 
è®¾Xå’ŒYä¸ºä¸¤ä¸ªéšæœºå˜é‡ï¼Œè‹¥å¯¹ä»»æ„ a<b,c<d,äº‹ä»¶{a<X<b} ä¸äº‹ä»¶{c<Y<d}å‡ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ç§°éšæœºå˜é‡Xå’ŒYç›¸äº’ç‹¬ç«‹
  + å®šç†
  è®¾ (X, Y)ä¸ºä¸¤ç»´éšæœºå‘é‡, X å’Œ Y ç›¸äº’ç‹¬ç«‹
    + (X, Y)ä¸ºç¦»æ•£å‹éšæœºå‘é‡
    P(X = xi,Y = Yj) = P(X=xi)P(Y=yj)
    + (X, Y)ä¸ºè¿ç»­å‹éšæœºå‘é‡
    f(x,y)=fX(x)fY(y)
  
+ æ€»ä½“åæ–¹å·®
  + $\mu_x = EX,\mu_y = EY$
  + $Cov(X,Y) = E[(X-\mu_x)(Y-\mu_y)]$
  + $Cov(X,X) = E[(X-\mu_x)(X-\mu_x)] = DX$
  
# å¤§æ•°å®šç†
>PPT4.2çš„48-52é¡µ

+ è´åŠªåˆ©å¤§æ•°å®šç†ï¼šè®¾mæ˜¯næ¬¡ç‹¬ç«‹é‡å¤è¯•éªŒä¸­äº‹ä»¶Aå‘ç”Ÿçš„æ¬¡æ•°ï¼Œ pæ˜¯æ¯æ¬¡å®éªŒAå‘ç”Ÿçš„æ¦‚ç‡ï¼Œåˆ™å¯¹ä»»æ„æ­£æ•°Îµ,æ€»æœ‰$lim_{n\to\infty}P(|\frac{m}{n}-p|<\epsilon) = 1$
+ åˆ‡æ¯”é›ªå¤«å¤§æ•°å®šç†ï¼šè®¾éšæœºå˜é‡Xiç›¸äº’ç‹¬ç«‹ä¸”å…·æœ‰ç›¸åŒçš„æ•°å­¦æœŸæœ›Î¼å’Œæ–¹å·®Ïƒ^2ï¼Œè‹¥ä»¤$\bar{X} = \frac{1}{n}\sum_{i=1}^n{X_i}$ï¼Œåˆ™å¯¹ä»»æ„æ•´æ•°$\epsilon$ï¼Œæ€»æœ‰ï¼š$lim_{n\to\infty}P(|\bar{X}-\mu|<\epsilon) = 1$
  + æ„ä¹‰ï¼šnè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œç®—æœ¯å¹³å‡å€¼ä¸ºä¸€å¸¸æ•°ï¼Œæ¥è¿‘ä¸æœŸæœ›

# ä¸­å¿ƒæé™å®šç†
>PPT4.2çš„53-60é¡µ

å‡è®¾è¢«ç ”ç©¶çš„å¯¹è±¡å¯ç”±å¤§é‡ç‹¬ç«‹å› ç´ çš„æ€»å’Œè§£é‡Šï¼Œå…¶ä¸­æ¯ä¸ªå› ç´ å¯¹äºæ€»å’Œçš„ä½œç”¨éƒ½å¾ˆå¾®å°ä¸”å¯æ¯”è¾ƒï¼Œåˆ™å½“å› ç´ æ•°ç›®å¾ˆå¤§æ—¶å°±å¯ä»¥è®¤ä¸ºè¿™ä¸ªå¯¹è±¡æœä»æ­£æ€åˆ†å¸ƒçš„
å¦‚æœéšæœºå˜é‡åºåˆ—$X_k(k=1,2,â€¦â€¦)$ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œå¹¶ä¸”æœ‰$E(X_k) = \mu$ï¼Œ$D(X_k) = \sigma^2$ï¼Œåˆ™æœ‰ï¼š$lim_{n\to\infty}P(\frac{\bar{X}-\mu}{\frac{\sigma}{\sqrt{n}}}) = \int_{-\infty}^{t}{\frac{1}{\sqrt{2\pi}}e^{-\frac{u^2}{2}}du}$ 

+ ä¸€èˆ¬å½¢å¼ï¼š$lim_{n\to\infty}P(\frac{f(X_n)-E[f(X_n)]}{\sqrt{D[f(X_n)]}}â‰¤t) = \Phi(t)$

+ äºŒé¡¹åˆ†å¸ƒçš„æ­£æ€è¿‘ä¼¼
$lim_{n\to\infty}P(\frac{X-np}{\sqrt{npq}}) = \int_{-\infty}^{t}{\frac{1}{\sqrt{2\pi}}e^{-\frac{u^2}{2}}du}$ 

+ æ³Šæ¾åˆ†å¸ƒçš„æ­£æ€è¿‘ä¼¼
$lim_{n\to\infty}P(\frac{X_n-n\lambda}{\sqrt{n\lambda}}) = \int_{-\infty}^{t}{\frac{1}{\sqrt{2\pi}}e^{-\frac{u^2}{2}}du}$

+ åº”ç”¨
  + å½“*æ ·æœ¬é‡æ¯”è¾ƒå¤§*æ—¶ï¼Œå¯ä»¥ç”¨æ¥å¯¹ç»™å®šçš„éšæœºå˜é‡çš„åˆ†å¸ƒè¿›è¡Œè¿‘ä¼¼
  + å½“ç ”ç©¶å¯¹è±¡å¯ä»¥è¡¨ç¤ºä¸º*ç‹¬ç«‹åŒåˆ†çš„æ€»å’Œ*æ—¶ï¼Œå¯ä»¥ç”¨æ­£æ€åˆ†å¸ƒæ¥è¿‘ä¼¼è®¡ç®—

# æ•°æ®
+ æ•°æ®çš„ç±»å‹ä¸æ•´ç†

> PPT5çš„5-8é¡µ

  + å®šä¹‰ï¼šæ•°æ®dataæ˜¯å¯¹å®¢è§‚äº‹ç‰©è®¡é‡çš„ç»“æœ
  å½¢å¼ï¼šæ•°å­—ã€å›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘
  æ•°æ®æ˜¯ç»Ÿè®¡åˆ†æçš„åŸºç¡€
  + ç±»å‹
    + å®šæ€§æ•°æ®qualitative data
      + å®šç±»æ•°æ®categorical dataï¼šæ€§åˆ«ã€è¡€å‹
      å®šä¹‰: äº‹ç‰©çš„å±æ€§æ•°æ®ï¼Œå¤šè¡¨ç°ä¸ºæ–‡å­—ç±»å‹çš„æ— åºç±»åˆ«æ•°æ®
      ç‰¹ç‚¹: æ— å¤§å°å…³ç³»ä¸èƒ½æ’åºï¼Œæ— åŠ å‡è¿ç®—
      + å®šåºæ•°æ®ordinal dataï¼šç–—æ•ˆã€ç—…æƒ…
      å®šä¹‰ï¼šæ˜¯å¯¹äº‹ç‰©ä¹‹é—´ç­‰çº§æˆ–é¡ºåºå·®åˆ«çš„è§‚æµ‹æ•°æ®ï¼Œ
æ•°æ®è¡¨ç°ä¸ºæœ‰åºç±»åˆ«
      ç‰¹ç‚¹ï¼šæœ‰é¡ºåºã€å¤§å°å…³ç³»ï¼Œä½†ä¸èƒ½åŠ å‡è¿ç®—
    + å®šé‡æ•°æ®quantitative dataï¼šå¹´é¾„ã€èº«é«˜ã€ä½“é‡
    å®šä¹‰: å¯¹äº‹ç‰©æŒ‰åº¦é‡å•ä½è¿›è¡Œè®¡é‡æˆ–è§‚æµ‹çš„æ•°æ®ï¼Œ
è¡¨ç°ä¸ºå…·ä½“çš„æ•°å€¼
    ç‰¹ç‚¹: æœ‰æ•°å€¼å¤§å°å…³ç³»ï¼Œèƒ½æ’åºå’ŒåŠ å‡è¿ç®—
      + ç¦»æ•£å‹å˜é‡ï¼šè§‚æµ‹åªå–æœ‰é™ä¸ªæˆ–å¯åˆ—ä¸ªå€¼
      + è¿ç»­å‹å˜é‡ï¼šå–æ— ç©·å¤šä¸ªå€¼ï¼Œå–å€¼è¿ç»­ä¸æ–­ä¸èƒ½ä¸€ä¸€åˆ—ä¸¾
      
+ æ•°æ®çš„ç»Ÿè®¡æ•´ç†å’Œå›¾ç¤º

> PPT5çš„9-21é¡µ

æ•°æ®çš„ç»Ÿè®¡æ•´ç†å°±æ˜¯æ ¹æ®ç»Ÿè®¡ç ”ç©¶çš„ä»»åŠ¡ï¼Œå¯¹æœé›†åˆ°çš„æ•°æ®èµ„æ–™è¿›è¡Œ*ç§‘å­¦çš„æ±‡æ€»å’Œå¤„ç†ï¼Œä½¿æ•°æ®èµ„æ–™ç³»ç»ŸåŒ–*ï¼Œ**ä»¥åæ˜ ç ”ç©¶æ€»ä½“çš„ç‰¹å¾ã€è§„å¾‹å’Œè¶‹åŠ¿**
  + æ•´ç†æ­¥éª¤ï¼šå®¡æ ¸å¹¶æ¸…æ´—æ•°æ®â†’åˆ†ç±»/åˆ†ç»„â†’æ±‡æ€»â†’ç»Ÿè®¡å›¾è¡¨æŠ¥å‘Š
  + æ•°æ®ç»Ÿè®¡æ•´ç†
    + å®šæ€§æ•°æ®ï¼šåˆ†ç±»æ•´ç†
    + å®šæ€§èµ„æ–™ï¼šå¸¸ç”¨æŒ‡æ ‡
    é¢‘ç‡ã€æ„æˆæ¯”ã€ç‡å’Œæ¯”
    + å®šé‡æ•°æ®ï¼šåˆ†ç»„æ•´ç†
    ç›®çš„ï¼š å±•ç¤ºå®šé‡æ•°æ®çš„åˆ†å¸ƒè§„å¾‹ã€ç‰¹å¾å’Œåˆ†å¸ƒç±»å‹
    æ­¥éª¤ï¼šç¡®å®šç»„æ•°â†’ç¡®å®šç»„è·â†’è®¡ç®—é¢‘æ•°â†’é¢‘æ•°åˆ†å¸ƒè¡¨â†’ç»Ÿè®¡å›¾ç¤º
      + ç»„æ•°ï¼šk = 1 +lnN/ln2
      + ç»„è·ï¼šd = [æœ€å¤§å€¼-æœ€å°å€¼/ç»„æ•°]ï¼ˆå–æ•´ï¼‰/åˆ†ä½æ•°

+ å®šé‡æ•°æ®åˆ†å¸ƒç‰¹å¾çš„ç»Ÿè®¡æè¿°
åˆ†å¸ƒçš„ä¸­å¿ƒã€æ•£å¸ƒç¨‹åº¦ã€å½¢çŠ¶ï¼šè§ã€æ•°æ®çš„æ¦‚æ‹¬æ€§åº¦é‡ã€‘éƒ¨åˆ†

## æ•°æ®æ¦‚æ‹¬æ€§åº¦é‡
+ ç»Ÿè®¡é‡æ„ä¹‰

>PPT5çš„22-28é¡µ

  + ä¸­å¿ƒè¶‹åŠ¿ï¼šå‡å€¼ã€ä¸­ä½æ•°
  + æ•£å¸ƒç¨‹åº¦ï¼šæ–¹å·®ã€æ ‡å‡†å·®ã€å˜å¼‚ç³»æ•°ã€æå·®ã€å››åˆ†ä½é—´è·
  + å½¢æ€ï¼šååº¦ã€å³°åº¦
  
+ å‡å€¼ã€æ–¹å·®ä¸æå€¼ã€æå·®
```{r}
data = c(1,2,3,4)
mean(data)
exp(mean(log(data)))# å‡ ä½•å¹³å‡
var(data)# æ–¹å·® 1/(n-1)
sd(data)# æ ‡å‡†å·® 1/(n-1)
se = sd(data)/sqrt(length(data))# æ˜¯sqrt(D(X_bar))
max(data) - min(data)
range(data)
```

+ åŸç‚¹çŸ©
```{r}
data = c(1,2,3,4)
library(moments)
moment(data)
```

-   é¢‘æ•°åˆ†å¸ƒ
```{r}
data = c(1,2,3,4)
breaks = seq(0, 5, length.out = 3)# åŒºé—´æ•°æ˜¯length.out - 1
data.cut = cut(data, breaks, right=FALSE)
data.freq = table(data.cut)
data.freq
```

+ åˆ†ä½æ•°
è®¾éšæœºå˜é‡Xï¼Œç»™å®šÎ±(0<Î±<1)ï¼Œå¦‚æœ‰æ•°xÎ±ï¼Œä½¿å¾—$P(Xâ‰¥x_\alpha)â‰¥\alpha$$P(Xâ‰¤x_\alpha)â‰¤1-\alpha$ï¼Œåˆ™ç§°xÎ±ä¸ºéšæœºå˜é‡Xçš„ä¸Šä¾§ Î± åˆ†ä½æ•°

```{r}
data = c(1,2,3,4)
quantile(data)
median(data)
quantile(data,0.5)
IQR(data)# å››åˆ†ä½é—´è·
```

+ å˜å¼‚ç³»æ•°
```{r}
data = c(1,2,3,4)
sd(data)/abs(mean(data))
```

+ ååº¦ä¸å³°åº¦
```{r}
library(moments)
skewness(iris$Sepal.Length)
kurtosis(iris$Sepal.Length)-3
# kurtosiså‡½æ•°é»˜è®¤ä»¥3ä¸ºé˜ˆå€¼ï¼Œæ‰€ä»¥éœ€è¦-3ä½¿å…¶ä»¥0ä¸ºé˜ˆå€¼
```

## æ•°æ®å¤„ç†å‡½æ•°
+ è¿ç®—å‡½æ•°
```{r}
x = 16.139
n = 3
abs(x)
sqrt(x)
round(x,n)# ä¿ç•™nä½å°æ•°
ceiling(x) # å‘ä¸Šå–æ•´
floor(x) # å‘ä¸‹å–æ•´
trunc(x) # å‘0å–æ•´
sin(x)
cos(x)
tan(x)
log(x,n)
exp(x) # e^x
```

+ å­—ç¬¦å‡½æ•°
  + è®¡ç®—xä¸­å­—ç¬¦æ•°é‡ncharï¼š(x)
  + æå–å‘é‡ä¸­çš„éƒ¨åˆ†å­—ç¬¦ï¼šsubstr(x,start,stop)
  + åœ¨xä¸­æœç´¢pattern, å¹¶ä»¥æ–‡æœ¬replacement å°†å…¶æ›¿æ¢ï¼šsub(pattern, replacement, x)
  + åœ¨splitå¤„åˆ†å‰²å­—ç¬¦å‘é‡xä¸­çš„å…ƒç´ ï¼šstrsplit(x, split)
  + è¿æ¥å­—ç¬¦ä¸²ï¼Œåˆ†éš”ç¬¦ä¸ºsepï¼špaste(â€¦â€¦, sep=" ")
  + å¤§å†™ï¼štoupper(x)
  + å°å†™ï¼štolower(x)

+ æ•°æ®å¤„ç†å‡½æ•°
  + è¾“å…¥å‘é‡ï¼Œè¿”å›æ’åºæ•°æ®ï¼šsort(x, na.last=NA, decreasing=FALSE)
  + è¾“å…¥å‘é‡ï¼Œè¿”å›æ’åºåæ•°æ®çš„indexï¼šorder(x, na.last=NA, decreasing=FALSE)
    + x[order(x)] == sort(x)
  + è¿”å›æ•°å€¼å¯¹åº”çš„ç§©æ¬¡/æ’ä½ï¼šrank(x, na.last=TRUE, ties.method=c(â€œaverageâ€, â€œfirstâ€, â€œrandomâ€, â€œmaxâ€, â€œminâ€))
    + sort(x)[rank(x, ties.method= "first")] == x
    + ties.methodï¼šå¤„ç†ç›¸åŒå€¼çš„æ–¹æ³•
  + æŒ‰æŸä¸€åˆ—çš„å€¼ç»™å…¨è¡¨æ ¼æ’åºï¼šcsv_sorted_age = csv[order(csv$age),]
  + æ¨ªå‘åˆå¹¶æ•°æ®æ¡†
  merge(x, y, by, by.x, by.y, all, all.x, all.y)
  + æŠ½æ ·å‡½æ•°
    + sample(x, size, replace=FALSE, prob=NULL) x, æ•°æ®ï¼›  size, æŠ½å–æ ·æœ¬æ•°ï¼› replace, æ”¾å›/ä¸æ”¾å›ï¼› prob, æƒé‡å‘é‡
    + seq(from = 1, to = 1, by = ((to - from)/(length.out - 1)), length.out = NULL) from, å¼€å§‹æ•°å­—ï¼›to, æœ€å¤§æ•°å­—ï¼› by, é—´éš”ï¼› length.out, åˆ†å‰²æˆå‡ åˆ†
  + æ•°æ®é‡å¡‘
    + melt(data, id, measure, variable.name, value.name, na.rm)
    dataï¼šè¦é‡å¡‘çš„æ•°æ®æ¡†ã€‚
    id.varsï¼šæŒ‡å®šé‚£äº›åœ¨é‡å¡‘åä»ç„¶ä¿æŒä¸ºåˆ—çš„å˜é‡ï¼Œé€šå¸¸æ˜¯æ ‡è¯†å˜é‡ï¼Œä¾‹å¦‚ä¸ªä½“çš„ç¼–å·ã€æ—¶é—´ç­‰ã€‚
    measure.varsï¼šæŒ‡å®šé‚£äº›è¦è¢«é‡å¡‘çš„æµ‹é‡å˜é‡åˆ—ï¼Œè¿™äº›åˆ—ä¸­çš„æ•°æ®ä¼šè¢«è½¬æ¢ä¸ºé•¿æ ¼å¼ä¸­çš„ä¸¤åˆ—ï¼ˆå˜é‡åå’Œå€¼ï¼‰ã€‚
    variable.nameï¼šæŒ‡å®šåœ¨é‡å¡‘ååŒ…å«åŸæµ‹é‡å˜é‡åç§°çš„æ–°åˆ—çš„åå­—ï¼Œé»˜è®¤æ˜¯ "variable"ã€‚
    value.nameï¼šæŒ‡å®šåœ¨é‡å¡‘ååŒ…å«åŸæµ‹é‡å˜é‡å€¼çš„æ–°åˆ—çš„åå­—ï¼Œé»˜è®¤æ˜¯ "value"ã€‚

    + melt()çš„é€†æ“ä½œï¼šdcast(data, formula, fun.aggregate = NULL, value.var, ...)
    formulaï¼šæŒ‡å®šå¦‚ä½•å°†æ•°æ®åˆ†ç»„å’Œå±•å¼€ä¸ºå®½æ ¼å¼ã€‚æ ¼å¼ä¸€èˆ¬ä¸º row_variables ~ column_variablesï¼Œå…¶ä¸­ row_variables æ˜¯å°†ä½œä¸ºå®½æ ¼å¼è¡Œçš„å˜é‡ï¼Œcolumn_variables æ˜¯å°†ä½œä¸ºå®½æ ¼å¼åˆ—çš„å˜é‡ã€‚
    + melt()+dcast()çš„è”åˆæ“ä½œï¼šrecast(data, formula, measure.vars, id.vars, fun.aggregate = NULL, value.var, ...)

+ å­—ç¬¦ä¸²å‡½æ•°
  + æŸ¥çœ‹é•¿åº¦ï¼šstr_length(x)
  + å­—ç¬¦åˆå¹¶ï¼šstr_c(x,collapse = " ")
  + å»æ‰ç©ºæ ¼å’ŒTABï¼šstr_trim(x)
  + å­—ç¬¦ä¸²å€¼æ’åºï¼šstr_sort(sample(LETTERS,10))
  + å­—ç¬¦ä¸²åˆ†å‰²ï¼šstr_split(x,"")
  + å¤§å†™ï¼šstr_to_upper(X)
  + å°å†™ï¼šstr_to_lower(x)
  
+ å…¶ä»–è¿›é˜¶æ“ä½œ
  + dplyråŒ…ï¼š
    + arrange()æ’åº
    å‡åºï¼š`arrange(df, asc(age))`
    é™åºï¼š`arrange(df, desc(age))`
    + filter()é€‰æ‹©è¡Œ`filter(df, age > 30, gender == "male")`
    + select()é€‰æ‹©åˆ—
      + è¿”å›æŒ‡å®šåˆ—`select(df, name, age)`
      + è¿”å›æŒ‡å®šå¤–åˆ—`select(carData, -vs, -am)`
    + mutate()æ·»åŠ æ–°åˆ—
      + æ·»åŠ åˆ—`mutate(df, age_plus_10 = age + 10)`
      + å»é™¤åˆ—`mutate(carData, drat=NULL, qsec=NULL)`
    + summarize()æ•°æ®æ±‡æ€»`summarise(df, avg_age = mean(age))`
    + table()å®šæ€§æ•°æ®æ•´ç†ï¼Œåšé¢‘æ•°åˆ†å¸ƒè¡¨
    + group_by()åˆ†ç»„`group_by(df, gender)`
    + inner_join() å†…è¿æ¥ï¼Œè¿”å›ä¸¤ä¸ªæ•°æ®æ¡†ä¸­éƒ½æœ‰çš„è¡Œ`inner_join(df1, df2, by = "id")`
    + left_join() å·¦è¿æ¥ï¼Œè¿”å› x æ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œï¼Œä»¥åŠ y æ•°æ®æ¡†ä¸­ä¸ x åŒ¹é…çš„è¡Œ`left_join(df1, df2, by = "id")`
    + right_join() å³è¿æ¥ï¼Œè¿”å› y æ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œï¼Œä»¥åŠ x æ•°æ®æ¡†ä¸­ä¸ y åŒ¹é…çš„è¡Œ`right_join(df1, df2, by = "id")`
    + full_join() å…¨è¿æ¥ï¼Œè¿”å›ä¸¤ä¸ªæ•°æ®æ¡†ä¸­çš„æ‰€æœ‰è¡Œ`full_join(df1, df2, by = "id")`
  + ç®¡é“`%>%`
  + `attach()`å‡½æ•°
```{r}
attach(iris)
```

  + æŸ¥çœ‹å˜é‡ç±»å‹ï¼šclass()å‡½æ•°
```{r}
data = data.frame(c(1,2,3),c(1,2,3))
data = as.matrix(data)
class(data)
```
  
  + rbind()å’Œcbind()å‡½æ•°
    rbindå‡½æ•°ç”¨äº*æŒ‰è¡Œåˆå¹¶çŸ©é˜µ*ï¼Œå³å°†ä¸€ä¸ªçŸ©é˜µçš„æ¯ä¸€è¡Œæ·»åŠ åˆ°å¦ä¸€ä¸ªçŸ©é˜µçš„æœ«å°¾ã€‚åˆå¹¶çš„å‰ææ˜¯ä¸¤ä¸ªçŸ©é˜µçš„åˆ—æ•°å¿…é¡»ç›¸åŒã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçŸ©é˜µAå’ŒBï¼ŒAæœ‰3è¡Œ4åˆ—ï¼ŒBä¹Ÿæœ‰3è¡Œ4åˆ—ï¼Œä½¿ç”¨**rbind(A,B)**å°†å¾—åˆ°ä¸€ä¸ª6è¡Œ4åˆ—çš„æ–°çŸ©é˜µã€‚å¦‚æœåˆ—æ•°ä¸åŒ¹é…ï¼ŒRä¼šæŠ›å‡ºé”™è¯¯ã€‚
    cbindå‡½æ•°ç”¨äº*æŒ‰åˆ—åˆå¹¶çŸ©é˜µ*ï¼Œå³å°†ä¸€ä¸ªçŸ©é˜µçš„æ¯ä¸€åˆ—æ·»åŠ åˆ°å¦ä¸€ä¸ªçŸ©é˜µçš„æœ«å°¾ã€‚åˆå¹¶çš„å‰ææ˜¯ä¸¤ä¸ªçŸ©é˜µçš„è¡Œæ•°å¿…é¡»ç›¸åŒã€‚ä¾‹å¦‚ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçŸ©é˜µAå’ŒCï¼ŒAæœ‰3è¡Œ4åˆ—ï¼ŒCæœ‰3è¡Œ5åˆ—ï¼Œä½¿ç”¨**cbind(A,C)**å°†å¾—åˆ°ä¸€ä¸ª3è¡Œ9åˆ—çš„æ–°çŸ©é˜µã€‚å¦‚æœè¡Œæ•°ä¸åŒ¹é…ï¼ŒRä¼šæŠ›å‡ºé”™è¯¯ã€‚
```{r}
a <- matrix(1:12, 3, 4)
b <- matrix(1:12, 3, 4)
y <- rbind(a, b)
print(y)
```

# æ ·æœ¬ã€ç»Ÿè®¡é‡ä¸æŠ½æ ·åˆ†å¸ƒ
+ æ€»ä½“ï¼šæ€»ä½“(population)æ˜¯æŒ‡æŒ‰ç ”ç©¶ç›®çš„æ‰€ç¡®å®šçš„ç ”ç©¶å¯¹è±¡ä¸­ï¼Œæ‰€æœ‰è§‚æµ‹ä¸ªä½“çš„æŸé¡¹è§‚æµ‹æŒ‡æ ‡å–å€¼çš„é›†åˆã€‚æ€»ä½“æ˜¯æœä»æŸç§åˆ†å¸ƒçš„éšæœºå˜é‡, è®°ä¸º Xã€‚
+ æ ·æœ¬ï¼šä»æ€»ä½“ä¸­éšæœºæŠ½å–çš„éƒ¨åˆ†ä¸ªä½“ï¼Œå³æ˜¯æ ·æœ¬ã€‚æ¯ä¸ªæ ·æœ¬ä¸æ€»ä½“ X çš„åˆ†å¸ƒç›¸åŒã€‚ (æŠ½æ ·çš„ä»£è¡¨æ€§)
  + ç®€å•éšæœºæ ·æœ¬ï¼šéšæœºç‹¬ç«‹æŠ½å–çš„æ ·æœ¬ X1, X2,â€¦â€¦,Xn 
+ æ ·æœ¬è§‚æµ‹å€¼ï¼šx1,x2,â€¦â€¦,xn

## ç»Ÿè®¡é‡
> PPT7.2çš„4-15é¡µ

**ä¸å«ä»»ä½•æœªçŸ¥å‚æ•°**çš„è§‚æµ‹æ ·æœ¬çš„å‡½æ•°
+ å®šä¹‰ï¼šè®¾X1ï¼Œ X2ï¼Œ â€¦ï¼Œ Xnæ˜¯æ¥è‡ªæ€»ä½“ X çš„æ ·æœ¬,x1ï¼Œ x2ï¼Œ â€¦ï¼Œ xnä¸ºå…¶æ ·æœ¬å€¼, åˆ™ç§°ä¸å«ä»»ä½•æœªçŸ¥å‚æ•°çš„å‡½æ•° ä¸ºç»Ÿè®¡é‡, ç›¸åº”å®æ•°ç§°ä¸ºå…¶æ ·æœ¬è§‚å¯Ÿ(æˆ–è§‚æµ‹)å€¼

+ å¸¸ç”¨ç»Ÿè®¡é‡
  + æ ·æœ¬å¹³å‡å€¼ï¼š$\bar{X} = \frac{1}{n}\sum{X_i}$
  + æ ·æœ¬æ–¹å·®ï¼ˆä¿®æ­£ï¼‰ï¼š$S^2 = \frac{1}{n-1}\sum(X_i-\bar{X})^2 = \frac{1}{n-1}(sum{X_i^2-n\bar{X}^2})$
  + æ ·æœ¬æ ‡å‡†å·®ï¼ˆä¿®æ­£ï¼‰ï¼š$S = \sqrt{S^2} = \sqrt{\frac{1}{n-1}\sum(X_i-X)^2}$ 
  + æ ·æœ¬æ ‡å‡†è¯¯ï¼š$S_{\bar{X}}=\frac{S}{\sqrt{n}}$
    
    > PPT7.2çš„14-15é¡µï¼šæ ‡å‡†å·®ä¸æ ‡å‡†è¯¯çš„è¾¨æ
    
  + æ ·æœ¬ké˜¶åŸç‚¹çŸ©ï¼š$A_k = \frac{1}{n}\sum{X_i^k},k=1,2,â€¦â€¦$
  + æ ·æœ¬ké˜¶ä¸­å¿ƒçŸ©ï¼š$B_k = \frac{1}{n}\sum(X_i-\bar{X})^k,k=2,3,â€¦â€¦$

+ å®šç†

>PPT7.2çš„10-13é¡µ

  + è®¾æ€»ä½“Xçš„å‡å€¼ä¸ºÎ¼ï¼Œæ–¹å·®ä¸ºÏƒ^2ï¼ŒX1ï¼Œâ€¦â€¦ï¼ŒXnæ˜¯æ€»ä½“Xçš„ä¸€ä¸ªæ ·æœ¬ï¼Œåˆ™æœ‰ï¼š$E(\bar{X}) = \mu,D(\bar{X}) = \frac{\sigma^2}{n},E(S^2) = \sigma^2$
  + è‹¥æ€»ä½“Xçš„ké˜¶çŸ©$E(X^k)$è®°æˆ$\mu_k$å­˜åœ¨ï¼Œåˆ™å½“$n\to\infty$ï¼Œ$A_k\to\mu_k$
  
## æŠ½æ ·åˆ†å¸ƒ

> PPT7.2çš„16-21ã€42-57é¡µ

ç»Ÿè®¡é‡çš„åˆ†å¸ƒç§°ä¸ºæŠ½æ ·åˆ†å¸ƒ
+ å®šç†
  + å¤§æ ·æœ¬ä¸‹ï¼Œæ ·æœ¬å‡å€¼è¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒï¼ˆä¸è¦æ±‚æ€»ä½“æ­£æ€ï¼‰ï¼šEXi = EX = Î¼ï¼ŒDXi = DX = Ïƒ^2
  + æ­£æ€æ€»ä½“çš„æ ·æœ¬å‡å€¼æœä»æ­£æ€åˆ†å¸ƒï¼š$\bar{X}$~$N(\mu,\frac{\sigma^2}{n})$
  + æ­£æ€æ€»ä½“æ ·æœ¬å‡å€¼ä¸æ–¹å·®çš„åˆ†å¸ƒï¼š$\bar{X}$~$N(\mu,\frac{\sigma^2}{n})$ï¼Œ$\frac{(n-1)S^2}{\sigma^2}$~$\chi^2(n-1)$ï¼Œ$\frac{\bar{X}-\mu}{S/\sqrt{n}}$~$t(n-1)$
  + ä¸¤ç‹¬ç«‹æ ·æœ¬ï¼š$\frac{S_1^2/S_2^2}{sigma_1^2/sigma_2^2}$~$F(n_1-1,n_2-1)$
  åŒæ–¹å·®æ—¶ï¼š$\frac{(\bar{X}-\bar{Y})-(\mu_1-\mu_2)}{S_\omega\sqrt{\frac{1}{n_1}+\frac{2}{n_2}}}$
  å…¶ä¸­ï¼Œ$S_\omega^2 = \frac{(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2}$
  
# åˆ†å¸ƒ
## æ­£æ€åˆ†å¸ƒ
+ æ±‚æ¦‚ç‡å¯†åº¦
```{r}
a = 72 # aå¯¹åº”çš„æ¦‚ç‡å¯†åº¦
dnorm(a, mean=72, sd=15.2)
```

+ åŒºé—´æ¦‚ç‡
```{r}
a = 170 # å¤§äºaçš„æ¦‚ç‡
pnorm(a, mean=172, sd=5, lower.tail=FALSE)
a = 70 # å¤§äºaçš„æ¦‚ç‡
pnorm(a, mean=60, sd=4, lower.tail=FALSE)

a = 170 # å°äºaçš„æ¦‚ç‡
pnorm(a, mean=172, sd=sqrt(0.08))

a = 4 # å¤§äºaã€å°äºbçš„æ¦‚ç‡
b = 10
pnorm(a, mean=1, sd=9, lower.tail=FALSE)-pnorm(10, mean=1, sd=9, lower.tail=FALSE)
```

+ å·²çŸ¥åŒºé—´æ¦‚ç‡ï¼Œæ±‚åŒºé—´è¾¹ç•Œ
```{r}
a = 0.975 # æ¦‚ç‡å¤§äºaçš„åŒºé—´
qnorm(a, mean=0, sd=1, lower.tail=TRUE)
```

+ ç”Ÿæˆæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r}
n = 100 # æ ·æœ¬æ•°
rnorm(n, mean=0, sd=1)
```

## tåˆ†å¸ƒ

> PPT7.2çš„35é¡µ

$\frac{N(0,1)}{\sqrt{\frac{{\chi}^2(n)}{n}}}$~t(n)
tåˆ†å¸ƒçš„å¯†åº¦æ›²çº¿ï¼šå…³äºyè½´å¯¹ç§°â†’å½“$df\to\infty$ï¼Œä¸ºæ ‡å‡†æ­£æ€åˆ†å¸ƒï¼›å½“df=1ï¼Œä¸ºæŸ¯è¥¿åˆ†å¸ƒ

+ æ±‚æ¦‚ç‡å¯†åº¦
```{r}
a = 1 # aå¯¹åº”çš„æ¦‚ç‡å¯†åº¦ï¼šæ¨ªåæ ‡â†’æ›²çº¿ä¸Šç‚¹
df = 3
dt(a, df)
```

+ åŒºé—´æ¦‚ç‡
```{r}
a = 4 # å¤§äºaçš„æ¦‚ç‡
df = 3
pt(a, df, lower.tail=FALSE)

a = 4 # å¤§äºaçš„æ¦‚ç‡
df = 3
pt(a, df)

a = 4 # å¤§äºaã€å°äºbçš„æ¦‚ç‡
b = 10
df = 3
pt(a, df, lower.tail=FALSE)-pt(b, df, lower.tail=FALSE)
```

+ å·²çŸ¥åŒºé—´æ¦‚ç‡ï¼Œæ±‚åŒºé—´è¾¹ç•Œ/åˆ†ä½ç‚¹
```{r}
a = 0.975 # æ¦‚ç‡å¤§äºaçš„åŒºé—´
df = 4
qt(a, df, lower.tail=TRUE)
```

+ ç”Ÿæˆæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r}
n = 100 # æ ·æœ¬æ•°
df = 5
rt(n, df)
```

## Ï‡2åˆ†å¸ƒ

>PPT7.2çš„22-33é¡µ

è®¾X1,X2,â€¦â€¦ï¼ŒXnæ˜¯æ¥è‡ªæ€»ä½“N(0,1)çš„ç‹¬ç«‹æ ·æœ¬ï¼Œåˆ™ç§°ç»Ÿè®¡é‡$\chi^2 = X_1^2+X_2^2+â€¦â€¦+X_n^2$æœä»è‡ªç”±åº¦ä¸ºnçš„$\chi^2$åˆ†å¸ƒï¼Œè®°ä¸º$\chi^2(n)$
è‡ªç”±åº¦ï¼šæŒ‡$\chi^2 = X_1^2+X_2^2+â€¦â€¦+X_n^2$ä¸­åŒ…å«ç‹¬ç«‹å˜é‡çš„ä¸ªæ•°
$N^2(0,1)$~$\chi^2(1)$


+ æ±‚æ¦‚ç‡å¯†åº¦
```{r}
a = 1 # aå¯¹åº”çš„æ¦‚ç‡å¯†åº¦ï¼šæ¨ªåæ ‡â†’æ›²çº¿ä¸Šç‚¹
df = 3
dchisq(a, df)
```

+ åŒºé—´æ¦‚ç‡
```{r}
a = 4 # å¤§äºaçš„æ¦‚ç‡
df = 3
pchisq(a, df, lower.tail=FALSE)

a = 4 # å¤§äºaçš„æ¦‚ç‡
df = 3
pchisq(a, df)

a = 4 # å¤§äºaã€å°äºbçš„æ¦‚ç‡
b = 10
df = 3
pchisq(a, df, lower.tail=FALSE)-pchisq(b, df, lower.tail=FALSE)
```

+ å·²çŸ¥åŒºé—´æ¦‚ç‡ï¼Œæ±‚åŒºé—´è¾¹ç•Œ
```{r}
a = 0.975 # æ¦‚ç‡å¤§äºaçš„åŒºé—´
df = 4
qchisq(a, df, lower.tail=TRUE)
```

+ ç”Ÿæˆæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r}
n = 100 # æ ·æœ¬æ•°
df = 5
rchisq(n, df)
```

## Fåˆ†å¸ƒ
$\frac{\frac{\chi^2(n_1)}{n_1}}{\frac{\chi^2(n_2)}{n_2}}$~$F(n_1,n_2)$
Fåˆ†å¸ƒçš„å¯†åº¦å‡½æ•°ä¸æ˜¯å¯¹ç§°åˆ†å¸ƒï¼Œæœ‰å…³ç³»$F_{1-\alpha}(n,m) = \frac{1}{F_{\alpha}(m,n)}$

+ æ±‚æ¦‚ç‡å¯†åº¦
```{r}
a = 1 # aå¯¹åº”çš„æ¦‚ç‡å¯†åº¦ï¼šæ¨ªåæ ‡â†’æ›²çº¿ä¸Šç‚¹
n1 = 2
n2 = 5
df(a,n1,n2)
```

+ åŒºé—´æ¦‚ç‡
```{r}
a = 4 # å¤§äºaçš„æ¦‚ç‡
n1 = 2
n2 = 5
pf(a,n1,n2,lower.tail=FALSE)

a = 4 # å¤§äºaçš„æ¦‚ç‡
n1 = 2
n2 = 5
pf(a,n1,n2)

a = 4 # å¤§äºaã€å°äºbçš„æ¦‚ç‡
b = 10
n1 = 2
n2 = 5
pf(a,n1,n2,lower.tail=FALSE)-pf(b,n1,n2,lower.tail=FALSE)
```

+ å·²çŸ¥åŒºé—´æ¦‚ç‡ï¼Œæ±‚åŒºé—´è¾¹ç•Œ
```{r}
a = 0.975 # æ¦‚ç‡å¤§äºaçš„åŒºé—´
n1 = 2
n2 = 5
qf(a,n1,n2,lower.tail=TRUE)
```

+ ç”Ÿæˆæ­£æ€æ€»ä½“çš„æ ·æœ¬
```{r}
n = 100 # æ ·æœ¬æ•°
n1 = 2
n2 = 5
rf(n, n1,n2)
```

## åˆ†å¸ƒä¹‹é—´çš„å…³ç³»
N(0,1)^2 = Ï‡2(1)
t(n)^2 = F(n-1,1)

# ä¼°è®¡é‡ä¼˜åŠ£çš„æ ‡å‡†
> PPT12çš„12-

## æ— åæ€§/å¯ä¿¡åº¦
ä¼°è®¡å€¼åœ¨æœªçŸ¥å‚æ•°çœŸå€¼é™„è¿‘æ‘†åŠ¨ï¼Œå®ƒçš„æœŸæœ›å€¼ç­‰äºæœªçŸ¥å‚æ•°çš„çœŸå€¼ï¼Œæ— åä¼°è®¡ä¸å”¯ä¸€
$E(\hat{\theta}-\theta) = 0$
+ æ ·æœ¬å‡å€¼ä¸æ–¹å·®çš„æ— åä¼°è®¡ï¼šè§ã€æ•°æ®æ¦‚æ‹¬æ€§åº¦é‡ã€‘/ã€ç»Ÿè®¡é‡ã€‘

## æœ‰æ•ˆæ€§/ç²¾åº¦
å½“æ ·æœ¬é‡ç›¸åŒæ—¶,æ–¹å·®å°çš„**æ— å**ä¼°è®¡é‡æ›´ä¸ºæœ‰æ•ˆ
$D(\hat{\theta_1})<D(\hat{\theta_2})$
+ å‡å€¼çš„æ— åä¼°è®¡
æ ·æœ¬å‡å€¼ä¸ºæ€»ä½“å‡å€¼Î¼çš„æ— åä¼°è®¡ï¼›åœ¨æ‰€æœ‰åŠ æƒå‡å€¼ä¸­ï¼Œæ ·æœ¬å‡å€¼æ˜¯æ€»ä½“å‡å€¼Î¼ çš„æœ€æœ‰æ•ˆä¼°è®¡

# ç‚¹ä¼°è®¡
## çŸ©ä¼°è®¡/ç‚¹ä¼°è®¡

> PPT12çš„1-8é¡µ

+ å®šä¹‰ï¼šç”¨**æ ·æœ¬çŸ©å»æ›¿æ¢æ€»ä½“çŸ©**ï¼Œç”¨æ ·æœ¬çŸ©çš„å‡½æ•°å»æ›¿æ¢ç›¸åº”çš„æ€»ä½“çŸ©çš„å‡½æ•°

+ ç†è®ºä¾æ®ï¼šåˆ‡æ¯”é›ªå¤«L.L.N.
**æ ·æœ¬ m é˜¶çŸ©ä¾æ¦‚ç‡æ”¶æ•›åˆ°ç†è®º m é˜¶çŸ©**

+ æ ·æœ¬çŸ©â†’æ€»ä½“çŸ©
$A_1 = \frac{1}{n}\sum{X_j} = \sum{x_i\frac{f_i}{n}} \to \mu_1 = EX = \sum{x_ip_i}$
$A_2 = \frac{1}{n}\sum{X_i^2} \to \mu_2 = E(X)^2 = \sum{x_i^2p_i}$
$A_m = \frac{1}{m}\sum{X_m^2} \to \mu_m = E(X)^2 = \sum{x_i^mp_i}$
  + å‡å€¼ï¼š$\mu = EX\to \hat{\mu} = \var{X}$
  + æ–¹å·®ï¼š$\sigma^2 = E(X^2)-E^2(X) \to \hat{\sigma}^2 = \frac{1}{n}\sum{(X_i-\bar{X})^2}$

## æå¤§ä¼¼ç„¶ä¼°è®¡

> PPT12çš„8-11é¡µ

+ æ€æƒ³ï¼šæ ·æœ¬æ¥è‡ªäºæ€»ä½“ï¼Œæ ·æœ¬åº”è¯¥å¾ˆå¥½åœ°åæ˜ æ€»ä½“çš„ç‰¹å¾ã€‚è®¾æ€»ä½“å«æœ‰å¾…ä¼°è®¡çš„å‚æ•°Î¸ï¼Œå®ƒå¯ä»¥å–å¾ˆå¤šå€¼ï¼Œåº”è¯¥åœ¨Î¸çš„ä¸€åˆ‡å¯èƒ½å–å€¼ä¹‹ä¸­é€‰å‡ºä¸€ä¸ªä½¿å¾—æ ·æœ¬è§‚æµ‹å€¼å‡ºç°çš„æ¦‚ç‡ä¸ºæœ€å¤§çš„ Î¸ å€¼æ¥ä½œä¸ºä¼°è®¡å€¼


# åŒºé—´ä¼°è®¡ï¼šç½®ä¿¡åŒºé—´
+ æ˜¾è‘—æ€§æ°´å¹³ä¸ç½®ä¿¡åŒºé—´
  + ç½®ä¿¡åŒºé—´é•¿åº¦ = $2*z_{\alpha/2}(\frac{\sigma}{\sqrt{n}})$
  + Î± = 0.05 å¯¹åº”95%ç½®ä¿¡åŒºé—´
  + ç½®ä¿¡æ°´å¹³æ˜¯æŒ‡æ„é€ æ€»ä½“å‚æ•°çš„å¤šä¸ªæ ·æœ¬åŒºé—´ä¸­ï¼ŒåŒ…å«æ€»ä½“å‚æ•°çš„åŒºé—´å æ€»æ•°ä¹‹æ¯”ï¼Œä¸€èˆ¬ç”¨1-Î±è¡¨ç¤ºï¼Œç½®ä¿¡åŒºé—´è¶Šå¤§ï¼Œç½®ä¿¡æ°´å¹³è¶Šé«˜
  + å•å°¾å’ŒåŒå°¾ï¼šåªå½±å“åŒºé—´èŒƒå›´ï¼ŒåŒºé—´çº¿ä¸‹é¢ç§¯å¯¹åº”æ˜¾è‘—æ€§æ°´å¹³
  95%çš„å•å°¾æ£€éªŒï¼š(5%,100%)æˆ–(0%,95%)
  95%çš„åŒå°¾æ£€éªŒï¼š(2.5%,97.5%)
  på€¼çš„å˜åŒ–ï¼š**åŒå°¾æ£€éªŒçš„på€¼æ˜¯å•å°¾æ£€éªŒçš„på€¼çš„ä¸¤å€**
  
+ è§£é‡Š

> PPT12çš„50-51é¡µ

å‚æ•°Î¼çš„95%CIçš„å«ä¹‰æˆ–è§£é‡Šï¼šè®¾è¿›è¡Œ100æ¬¡é‡å¤éšæœºæŠ½æ ·ï¼Œæ¯æ¬¡æŠ½æ ·è®¡ç®—å‚æ•°Î¼çš„95%ç½®ä¿¡åŒºé—´ï¼Œæœ€ç»ˆè·å¾—100ä¸ªÎ¼çš„ç½®ä¿¡åŒºé—´ï¼Œé‚£ä¹ˆï¼Œå…¶ä¸­çº¦æœ‰95ä¸ªçš„åŒºé—´åŒ…å«å‚æ•°Î¼çš„çœŸå®å€¼Î¼0

ç½®ä¿¡åŒºé—´åº¦é‡çš„æ˜¯åœ¨æŸä¸€ç½®ä¿¡æ°´å¹³ä¸‹ï¼Œæ ·æœ¬ç»Ÿè®¡å€¼ä¸
æ€»ä½“å‚æ•°å€¼é—´çš„è¯¯å·®èŒƒå›´

+ æ€§è´¨
  + ç½®ä¿¡åŒºé—´æ˜¯ä¸€ä¸ªéšæœºåŒºé—´ï¼Œæ¯æ¬¡æŠ½æ ·ï¼ŒåŒºé—´æœ‰æ‰€ä¸åŒï¼Œæœ‰æ—¶ç½®ä¿¡åŒºé—´ä¸åŒ…å«çœŸå®çš„å‚æ•°
  + ç½®ä¿¡åº¦ Î± å›ºå®šæ—¶ï¼Œç½®ä¿¡åŒºé—´é•¿åº¦è¶ŠçŸ­ï¼Œå…¶åŒºé—´ä¼°è®¡çš„ç²¾åº¦è¶Šé«˜
  + å®é™…åº”ç”¨ä¸­ï¼Œé€šå¸¸ç»™å®šä¸€å®šçš„ç½®ä¿¡åº¦ï¼Œæ±‚å°½å¯èƒ½çŸ­çš„ç½®ä¿¡åŒºé—´
  + ç½®ä¿¡åŒºé—´ä¸ç½®ä¿¡æ°´å¹³å’Œæ ·æœ¬é‡ç­‰å› ç´ æœ‰å…³
    + åœ¨ç½®ä¿¡æ°´å¹³å›ºå®šçš„æƒ…å†µä¸‹ï¼Œ*æ ·æœ¬é‡è¶Šå¤šï¼Œç½®ä¿¡åŒºé—´è¶Šçª„*
    + åœ¨æ ·æœ¬é‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œ*ç½®ä¿¡æ°´å¹³è¶Šé«˜ï¼Œç½®ä¿¡åŒºé—´è¶Šå®½*

## å•ä¸ªæ­£æ€æ€»ä½“
### æ±‚ä¸Šä¸‹ç•Œ
```{r}
# Nåˆ†å¸ƒ
# å•ä¾§
miu = 0
sigma2 = 9
a = 0.05
qnorm(a,miu,sqrt(sigma2),lower.tail = FALSE)# ä¸Šç•Œ
qnorm(a,miu,sqrt(sigma2))# ä¸‹ç•Œ
# åŒä¾§
miu = 0
sigma2 = 1
a = 0.05
qnorm(a/2,miu,sqrt(sigma2),lower.tail = FALSE)
qnorm(a/2,miu,sqrt(sigma2))

# tåˆ†å¸ƒ
# å•ä¾§
n = 3
a = 0.05
qt(a,n,lower.tail = FALSE)# ä¸Šç•Œ
qt(a,n)# ä¸‹ç•Œ
# åŒä¾§
n = 3
a = 0.05
qt(a/2,n,lower.tail = FALSE)
qt(a/2,n)

# å¡æ–¹åˆ†å¸ƒ
# å•ä¾§
n = 4
a = 0.1
qchisq(a,n,lower.tail = FALSE)# ä¸Šç•Œ
qchisq(1-a,n,lower.tail = FALSE)# ä¸‹ç•Œ
# åŒä¾§
n = 4
a = 0.1
qchisq(a/2,n,lower.tail = FALSE)
qchisq(1-a/2,n,lower.tail = FALSE)

# Fåˆ†å¸ƒ
# å•ä¾§
n = 4
m = 5
a = 0.1
qf(a,n,m,lower.tail = FALSE)# ä¸Šç•Œ
qf(1-a,n,m,lower.tail = FALSE)# ä¸‹ç•Œ
# åŒä¾§
n = 4
m = 5
a = 0.1
qf(a/2,n,m,lower.tail = FALSE)
qf(1-a/2,n,m,lower.tail = FALSE)
```

### å‡å€¼

> PPT12çš„25-31é¡µ

+ æ–¹å·®å·²çŸ¥
```{r}
# ç»™å‡ºå…·ä½“æ•°æ®
data = c(1,2,3,4)
a = 0.05
sigma2 = 3
n = length(data)
mean = mean(data)
mean - sqrt(sigma2)*qnorm(a/2,lower.tail = FALSE)/sqrt(n)
mean + sqrt(sigma2)*qnorm(a/2,lower.tail = FALSE)/sqrt(n)

# ä¸ç»™å…·ä½“æ•°æ®
a = 0.05
sigma2 = 9
n = 100
mean = 122
mean - sqrt(sigma2)*qnorm(a/2,lower.tail = FALSE)/sqrt(n)
mean + sqrt(sigma2)*qnorm(a/2,lower.tail = FALSE)/sqrt(n)

# ç»™å‡ºåŒºé—´é•¿åº¦ï¼Œæ±‚æ ·æœ¬é‡n
a = 0.05
length = 1
sigma2 = 9
(2*sqrt(sigma2)*qnorm(a/2,lower.tail = FALSE)/length)^2
```

+ æ–¹å·®æœªçŸ¥
```{r}
data = c(1,2,3,4)
a = 0.05
n = length(data)
mean = mean(data)
sd = sd(data)
mean - sd*qt(a/2,n-1,lower.tail = FALSE)/sqrt(n)
mean + sd*qt(a/2,n-1,lower.tail = FALSE)/sqrt(n)
```

### æ–¹å·®

> PPT12çš„32é¡µ

```{r}
data = c(5.3,6.6,5.2,3.7,4.9)
a = 0.10
n = length(data)
var = var(data)
(n-1)*var(data)/qchisq(a/2,n-1,lower.tail = FALSE)
(n-1)*var(data)/qchisq(1-a/2,n-1,lower.tail = FALSE)
```

## ä¸¤ä¸ªæ­£æ€æ€»ä½“
+ å‡å€¼é€‰æ‹©æ£€éªŒæ€è·¯
  + é…å¯¹è®¾è®¡â†’å•æ ·æœ¬\é…å¯¹tæ£€éªŒ
  + æˆç»„è®¾è®¡â†’
    + æ€»ä½“æ–¹å·®æœªçŸ¥â†’æ–¹å·®é½æ€§æ£€éªŒFæ£€éªŒâ†’
      + æ–¹å·®é½æ€§â†’tæ£€éªŒ
      + æ–¹å·®ä¸é½æ€§â†’tâ€™æ£€éªŒ
    + æ€»ä½“æ–¹å·®å·²çŸ¥â†’uæ£€éªŒ
    
### å‡å€¼å·®
+ æ–¹å·®å·²çŸ¥

> PPT12çš„39é¡µ

```{r}
    data1 = c(1,2,3,4)
    data2 = c(2,3,4,5)
    a = 0.05
    sigma21 = 3
    sigma22 = 4
    n = length(data1)
    m = length(data2)
    mean = mean(data1)-mean(data2)
    mean - qnorm(a/2,lower.tail = FALSE)*sqrt(sigma21/n+sigma22/m)
    mean + qnorm(a/2,lower.tail = FALSE)*sqrt(sigma21/n+sigma22/m)
```

+ æ–¹å·®æœªçŸ¥
    + æ–¹å·®ç›¸åŒ
    
    > PPT12çš„40é¡µ
    
```{r}
data1 = c(1,2,3,4)
data2 = c(2,3,4,5)
a = 0.05
sigma2 = 3
n = length(data1)
m = length(data2)
mean = mean(data1)-mean(data2)
var1 = var(data1)
var2 = var(data2)
Sw = sqrt(((n-1)*var1+(m-1)*var2)/(n+m-2))
mean - qt(a/2,n+m-2,lower.tail = FALSE)*sqrt(1/n+1/m)*Sw
mean + qt(a/2,n+m-2,lower.tail = FALSE)*sqrt(1/n+1/m)*Sw
```

  + æ–¹å·®ä¸åŒ
  
  > PPT12çš„41é¡µ
  
```{r}
data1 = c(1,2,3,4)
data2 = c(2,3,4,5)
a = 0.05
n = length(data1)
m = length(data2)
mean = mean(data1)-mean(data2)
var1 = var(data1)
var2 = var(data2)
v = (var1/n+var2/m)^2/(var1^2/(n^2*(n-1))+var2^2/(m^2*(m-1)))
mean - qt(a/2,v,lower.tail = FALSE)*sqrt(var1/n+var2/m)
mean + qt(a/2,v,lower.tail = FALSE)*sqrt(var1/n+var2/m)
```

### æ–¹å·®æ¯”

> PPT12çš„42é¡µ

+ å‡å€¼å·²çŸ¥
```{r}
data1 = c(1,2,3,4)
data2 = c(2,3,4,5)
a = 0.05
n = length(data1)
m = length(data2)
miu1 = 2
miu2 = 3
var1 = sum((data1 - miu1)^2)/n
var2 = sum((data2 - miu2)^2)/m
var1/(var2*qf(a/2,n,m,lower.tail = FALSE))
var1/(var2*qf(1-a/2,n,m,lower.tail = FALSE))
```

+ å‡å€¼æœªçŸ¥

> PPT12çš„43é¡µ

```{r}
data1 = c(1,2,3,4)
data2 = c(2,3,4,5)
a = 0.05
n = length(data1)
m = length(data2)
var1 = var(data1)
var2 = var(data2)
var1/(var2*qf(a/2,n-1,m-1,lower.tail = FALSE))
var1/(var2*qf(1-a/2,n-1,m-1,lower.tail = FALSE))
```

## éæ­£æ€æ€»ä½“
### äºŒé¡¹åˆ†å¸ƒ

> PPT12çš„44-47é¡µ

+ n\>=30
  + å•ä¸ªæ€»ä½“
```{r}
n = 60 # å°è¯•æ¬¡æ•°
m = 40 # æˆåŠŸæ¬¡æ•°
a = 0.05
est_p = m/n
est_p - qnorm(a/2,lower.tail = FALSE)*sqrt(est_p*(1-est_p)/n)
est_p + qnorm(a/2,lower.tail = FALSE)*sqrt(est_p*(1-est_p)/n)

# prop.test()å‡½æ•°
prop.test(x = m, n = n, conf.level = a, correct = FALSE)# correct = TRUEï¼šè¿›è¡Œè¿ç»­æ€§æ ¡æ­£
```

  + ä¸¤ä¸ªæ€»ä½“
```{r}
n1 = 50
n2 = 60
m1 = 30
m2 = 40
a = 0.05
est_p1 = m1/n1
est_p2 = m2/n2
est_p = est_p1 - est_p2
est_sigma = sqrt(est_p1*(1-est_p1)/n1+est_p2*(1-est_p2)/n2)
est_p - qnorm(a/2,lower.tail = FALSE)*est_sigma
est_p + qnorm(a/2,lower.tail = FALSE)*est_sigma
```

+ n\<30
```{r}
n = 15# æ€»å®éªŒæ¬¡æ•°
m = 6# æˆåŠŸæ¬¡æ•°
binom.test(m,n,conf.level = 0.95)
```

+ è‹¥è¦æ±‚ç»™å®šçš„ç½®ä¿¡åŒºé—´é•¿åº¦ä¸è¶…è¿‡ç»™å®šçš„æ­£æ•°ğ›¿

> PPT12çš„54é¡µ

```{r}
n = 60 # å°è¯•æ¬¡æ•°
m = 40 # æˆåŠŸæ¬¡æ•°
a = 0.05
delta = 0.1
est_p = m/n
qnorm(a/2,lower.tail = F)*est_p*(1-est_p)/(delta^2/4)
```


### æ³Šæ¾åˆ†å¸ƒ

> PPT12çš„48é¡µ

+ n>=30
```{r}
n = 60
lambda = 5
a = 0.05
data = rpois(n, lambda)
est_lambda = sum(data)/n
est_lambda - qnorm(a/2,lower.tail = FALSE)*sqrt(est_lambda/n)
est_lambda + qnorm(a/2,lower.tail = FALSE)*sqrt(est_lambda/n)
```

+ n<30
```{r}
m = 5# è§‚å¯Ÿåˆ°çš„äº‹ä»¶æ¬¡æ•°
poisson.test(m,conf.level = 0.95)
```


# å‚æ•°å‡è®¾æ£€éªŒ
## åŸºæœ¬æ­¥éª¤

> PPT13çš„14-21é¡µ

## ä¸¤ç±»é”™è¯¯
+ Iç±»é”™è¯¯ï¼šğ»0æ­£ç¡®ï¼Œå´è¢«æ‹’ç»ï¼ˆå³ç›®å‰æ‹’ç»äº†H0ï¼‰â€”â€”å¼ƒçœŸé”™è¯¯
  çŠ¯é”™æ¦‚ç‡ï¼š*P = æ£€éªŒæ°´å¹³Î±*
+ IIç±»é”™è¯¯ï¼šğ»0é”™è¯¯ï¼Œå´æ²¡è¢«æ‹’ç»ï¼ˆå³ç›®å‰æ¥å—äº†H0ï¼‰â€”â€”å­˜ä¼ªé”™è¯¯
  + çŠ¯é”™æ¦‚ç‡ï¼š*P = Î²*
  + æ£€éªŒçš„*åŠŸæ•ˆï¼š1-Î²*
+ ä¸¤è€…å…³ç³»ï¼š**Î±â†“Î²â†‘**
å‡å°‘çŠ¯ç¬¬1ç±»é”™è¯¯çš„æ¦‚ç‡ï¼Œä¼šå¯¼è‡´çŠ¯ç¬¬2ç±»é”™è¯¯çš„æ¦‚ç‡å¢åŠ 
+ çœŸå®å·®å¼‚|Î¼-Î¼0|â†‘ã€Î²â†“ã€(1-Î²)â†‘
çœŸå®å·®å¼‚è¶Šå¤§ï¼Œå‘ç°å·®å¼‚æœºä¼šè¶Šå¤§ï¼ŒåŠŸæ•ˆè¶Šå¤§
+ æ£€éªŒåŸåˆ™ï¼š**åœ¨æ§åˆ¶çŠ¯ç¬¬ä¸€ç±»é”™è¯¯çš„å‰æä¸‹ï¼Œå°½å¯èƒ½å‡å°çŠ¯ç¬¬äºŒç±»çš„æ¦‚ç‡**
+3ä¸ªåº”ç”¨
  1.è®¡ç®—æ ·æœ¬é‡ï¼šè®¾å®šåŠŸæ•ˆï¼Œåæ¨æ ·æœ¬é‡
  2.è¯„ä»·å‡è®¾æ£€éªŒæ–¹æ³•çš„ä¼˜åŠ£ï¼šæ§åˆ¶Î±ï¼Œçœ‹Î²
  3.ROCæ›²çº¿ï¼Œåˆ¤æ–­è¯Šæ–­ç²¾ç¡®æ€§
  
## å•ä¸ªæ­£æ€æ€»ä½“
t.test é»˜è®¤ä¸¤ç»„æ•°æ®é—´ç›¸äº’ç‹¬ç«‹ï¼ˆé»˜è®¤å‚æ•° paired = FALSEï¼‰ï¼Œæ‰§è¡Œç‹¬ç«‹æ ·æœ¬çš„ t æ£€éªŒï¼›
é»˜è®¤æ–¹å·®ä¸ç›¸ç­‰ ï¼ˆé»˜è®¤å‚æ•° var.equal = FALSEï¼‰ ï¼› é»˜è®¤çš„å¤‡æ‹©å‡è®¾æ˜¯åŒä¾§çš„ï¼ˆé»˜è®¤å‚æ•° alternative = 'two.sided'ï¼‰ï¼Œå³æ‰§è¡ŒåŒä¾§æ£€éªŒ
+ å‡å€¼
    + H0ï¼šå‡å€¼ç­‰äºÎ¼0
```{r}
data = c(1,2,3,4,5)
h0 = 7
a = 0.05
t.test(x = data, y = NULL, alternative ="two.sided", miu = h0, level = 1-a)
```

    + H0ï¼šå‡å€¼å¤§äºÎ¼0
```{r}
data = c(1,2,3,4,5)
h0 = 7
a = 0.05
t.test(x = data, y = NULL, alternative ="greater", miu = h0, level = 1-a)
```

    + H0ï¼šå‡å€¼å°äºÎ¼0
```{r}
data = c(1,2,3,4,5)
h0 = 7
a = 0.05
t.test(x = data, y = NULL, alternative ="less", miu = h0, level = 1-a)
```

+ æ–¹å·®
```{r}
data = c(1,2,3,4,5)
h0 = 3
a = 0.05
n = length(data)
var = var(data)
sigma = h0
df = n-1
chisq2 = df*var/sigma
q = pchisq(chisq2, df)
```

- æ³Šæ¾åˆ†å¸ƒâ†’æ­£æ€åˆ†å¸ƒï¼šÎ»æ£€éªŒ
```{r}
x_bar = 1.5
lambda0 = 1
a = 0.05
z = (x_bar - lambda0) / sqrt(lambda0 / n)
p_value = pnorm(z,0,1,lower.tail = FALSE)
up = qnorm(a/2,0,1,lower.tail = FALSE)
down = qnorm(a/2,0,1)
data.frame(z,p_value,up,down)
```


## ä¸¤ä¸ªæ­£æ€æ€»ä½“
-   æ­£æ€æ€§æ£€éªŒ
    ```{r}
    data1 = c(11.3,15.0,15.0,13.5,12.8,10.0,11.0,12.0,13.0,12.3)
    data2 = c(14.0,13.8,14.0,13.5,13.5,12.0,14.7,11.4,13.8,12.0)
    shapiro.test(data1)
    shapiro.test(data2)# æ£€æµ‹æ˜¯å¦æ­£æ€
    ks.test(data, "pnorm", mean = mean(data), sd = sd(data))# å¯ä»¥æ£€æµ‹å¤šç§åˆ†å¸ƒ
    ```

-   æ–¹å·®é½æ¬¡æ€§æ£€éªŒ

```{r}
data1 = c(3,5,7,9,10)
data2 = c(1,2,4,6,8,4)
h0 = 1
a = 0.05
var.test(x=data1, y=data2, ratio = h0,alternative="two.sided",conf.level=1-a )
bartlett.test(list(data1,data2)) # <0.05åˆ™æ–¹å·®æ˜¯éé½æ€§
```

+ é…å¯¹å‡å€¼æ£€éªŒ
å‰æï¼šæ ·æœ¬å·®å€¼diç‹¬ç«‹åŒåˆ†å¸ƒï¼Œä¸”æœä»æ­£æ€åˆ†å¸ƒ
```{r}
data1 = c(0.580,0.509,0.5,0.316,0.337,0.517,0.454,0.512,0.997,0.506)
data2 = c(0.84,0.591,0.674,0.632,0.687,0.978,0.750,0.730,1.2,0.87)
a = 0.05
t.test(x=data1, y=data2,df = length(data1),alternative = "two.sided",paired = TRUE,conf.level = 1-a )
```

-   ä¸é…å¯¹å‡å€¼æ£€éªŒ

```{r}
x <- c(4.05, 4.18, 5.93, 4.3, 2.41, 5.6, 6.61, 2.98, 5.93, 4.18, 4.05, 3.62)
y <- c(4.54, 4.63, 3.64, 5.07, 6.44, 5.62, 6.14, 4.81, 6.42, 5.35)
shapiro.test(x) # å…ˆæ£€æµ‹æ˜¯å¦ä¸ºæ­£æ€åˆ†å¸ƒ
shapiro.test(y)
bartlett.test(list(a=x,b=y))
t.test(x,y, alternative="less", var.equal=TRUE)
```

-   æ–¹å·®é½æ¬¡

```{r}
data1 = c(3,5,7,9,10)
data2 = c(1,2,4,6,8,4)
a = 0.05
t.test( x=data1, y=data2,alternative = "two.sided",paired = FALSE,conf.level = 1-a )
```

-   æ–¹å·®ä¸é½æ¬¡

```{r}
data1 = rnorm(10,8,2)
data2 = rnorm(10,5,1)
a = 0.05
t.test( x=data1, y=data2,alternative = "two.sided",paired = FALSE,var.equal = FALSE, conf.level = 1-a )
```

# éå‚æ•°å‡è®¾æ£€éªŒ
+ ç¬¦å·æ£€éªŒä¸ç§©æ£€éªŒï¼š
 ç¬¦å·æ£€éªŒï¼šbinom.test()
 Wilcoxonç¬¦å·ç§©æ£€éªŒå’Œç§©å’Œæ£€éªŒï¼šwilcox.test()
+ æ‹Ÿåˆä¼˜åº¦æ£€éªŒ
 Pearsonå¡æ–¹æ£€éªŒï¼šchisq.test()
 Kolmogorov-Smirnovæ£€éªŒï¼šks.test()
+ åˆ—è”è¡¨æ£€éªŒï¼š
 Pearsonå¡æ–¹æ£€éªŒï¼šchisq.test()
 Fisherç²¾ç¡®æ£€éªŒï¼šfisher.test()
## å¡æ–¹æ‹Ÿåˆä¼˜åº¦æ£€éªŒ
+ å•æ•°æ®æ˜¯å¦ç¬¦åˆæ­£æ€åˆ†å¸ƒ
```{r}
data = c(1,2,3,4,5)
    shapiro.test(data)# æ£€æµ‹æ˜¯å¦æ­£æ€
    ks.test(data, "pnorm", mean = mean(data), sd = sd(data))# å¯ä»¥æ£€æµ‹å¤šç§åˆ†å¸ƒ
```

+ ä¸¤ä¸ªæ•°æ®åˆ†å¸ƒæ˜¯å¦ä¸€æ ·
```{r}
# H0ï¼šå¤§å­¦ç”Ÿé€‰æ‹©äº”ä¸ªå“ç‰Œçš„æ¦‚ç‡ç›¸åŒ
observed = c(315,108,101,32)
expected = c(09/16,3/16,3/16,1/16)
chisq.test(observed,p = expected)

# åŒæ ·æœ¬ksæ£€éªŒ
mu = 70
sd = 10
set.seed(123)
x = round(rnorm(30,mu,sd))
y = round(runif(30, 0, 100))
  # round()å‡½æ•°ç”¨äºå°†æ•°å€¼å››èˆäº”å…¥åˆ°ç‰¹å®šçš„å°æ•°ä½æ•°
ks.test(x, y)
```

+ çœ‹æ•°æ®æ˜¯å¦ç¬¦åˆç‰¹å®šåˆ†å¸ƒ
```{r}
# å‡åŒ€åˆ†å¸ƒ
x = c(64, 68, 86, 71, 71, 87, 75, 57, 63, 66, 82, 74, 74, 71, 64, 88, 75, 50, 77, 65, 59, 68, 60, 63, 64, 53, 78, 72, 59, 83)

ks.test(x, 'punif', 0, 100) # æˆç»©æ˜¯å¦ç¬¦åˆä»0-100çš„å‡åŒ€åˆ†å¸ƒï¼Ÿ
# æœ‰ç›¸åŒå€¼çš„æ—¶å€™ï¼Œkså¯èƒ½ä¸å‡†
```

+ æç¤º
chisq.test()é€‚åˆæ£€éªŒåˆ†ç»„å˜é‡
ks.test()ä¸éœ€è¦å°†æ ·æœ¬åˆ†ç»„ï¼Œé€‚åˆäºæ£€æµ‹æ£€éªŒè¿ç»­å˜é‡ï¼Œä¸é€‚åˆå¤„ç†ç¦»æ•£å˜é‡
tieè¾ƒå¤šçš„æ—¶å€™ï¼Œks.test()çš„ç»“æœä¸å¯é 

## åˆ—è”è¡¨æ£€éªŒ
+ æ³¨æ„
n â‰¥ 40ï¼Œä¸”æ¯ä¸ªæ ¼å­çš„ç†è®ºé¢‘æ•°â‰¥ 5 æ—¶ï¼Œé‡‡ç”¨å¡æ–¹æ£€éªŒ`chisq.test()`
 å¯¹äºn â‰¥ 40ä¸”æœ‰æ ¼å­çš„ç†è®ºé¢‘æ•°< 5 ä½†éƒ½ â‰¥ 1 æ—¶ï¼Œé‡‡ç”¨ Yates è¿ç»­æ€§çŸ«æ­£çš„å¡æ–¹æ£€éªŒ`chisq.test(correct = T)`
 å¯¹äºn â‰¤ 40ï¼Œæˆ–è€…n > 40ä¸”è‡³å°‘æœ‰æ ¼å­çš„ç†è®ºé¢‘æ•°â‰¤1 æ—¶ï¼Œé‡‡ç”¨ Fisher ç²¾ç¡®ç‹¬ç«‹æ€§æ£€éªŒfisher.test()

+ ç‹¬ç«‹æ€§ï¼šä¸¤å˜é‡æ˜¯å¦ç›¸å…³
```{r}
M <- as.table(rbind(c(66,16), c(28,18))) 
dimnames(M) <- list(cancer = c("Y", "N"),smoke = c("Y", "N")) 
chisq.test(M, correct = F)
```

+ é½æ¬¡æ€§ï¼šå¦‚ç®—å‘ç—…ç‡æœ‰æ— å˜åŒ–
```{r}
# 2*3åˆ—è”è¡¨
M <- as.table(rbind(c(120,25), c(50,27),c(40,22))) 
p_effective = (120+50+40)/(120+25+50+27+40+22)
p_ineffective = (25+27+22)/(120+25+50+27+40+22)
chisq.test(M, correct = F)

# 2*2åˆ—è”è¡¨
M <- as.table(rbind(c(81,83), c(19,32))) # ç¬¬ä¸€è¡Œï¼Œç¬¬äºŒè¡Œ
chisq.test(M, correct = F)
```

### 2*2åˆ—è”è¡¨
+ n>=40ï¼Œä¸”æ¯ä¸ªE>=5ï¼šå¡æ–¹æ£€éªŒ
```{r}
M <- as.table(rbind(c(12,32), c(22,14))) # ç¬¬ä¸€è¡Œï¼Œç¬¬äºŒè¡Œ
chisq.test(M, correct = F)
```


+ n\>=40, 1\<E\<5ï¼šyatesè¿ç»­æ€§æ ¡æ­£
```{r}
a = 30# 1è¡Œ1
b = 45# 1è¡Œ2
c = 3# 2è¡Œ1
d = 50# 2è¡Œ2
chisq2 = (a+b+c+d)*(abs(a*d-b*c)-0.5*n)^2/((a+b)*(c+d)*(a+c)*(b+d))
chisq2
# æˆ–è€…ç”¨chisq.testå‡½æ•°
M <- as.table(rbind(c(81,83), c(19,32))) # ç¬¬ä¸€è¡Œï¼Œç¬¬äºŒè¡Œ
chisq.test(M, correct = T)
```

+ n\<=40æˆ–E\<1ï¼šfisherç²¾ç¡®æ£€éªŒ
```{r}
data = matrix(c(1,2,3,4),ncol = 2,nrow = 2)
fisher.test(data)
```

+ è®¡ç®—ç†è®ºé¢‘æ•°çŸ©é˜µ
```{r}
# å®šä¹‰ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—ç†è®ºé¢‘æ•°çŸ©é˜µ
calculate_expected_frequencies <- function(observed_matrix) {
  # æ£€æŸ¥è¾“å…¥çŸ©é˜µæ˜¯å¦ä¸º2x2
  if (nrow(observed_matrix) != 2 || ncol(observed_matrix) != 2) {
    stop("è¾“å…¥çš„çŸ©é˜µå¿…é¡»æ˜¯2x2çš„åˆ—è”è¡¨")
  }
  
  # è®¡ç®—è¡Œæ€»å’Œã€åˆ—æ€»å’Œå’Œæ€»å’Œ
  row_sums <- rowSums(observed_matrix)
  col_sums <- colSums(observed_matrix)
  total_sum <- sum(observed_matrix)
  
  # è®¡ç®—ç†è®ºé¢‘æ•°çŸ©é˜µ
  expected_matrix <- matrix(0, nrow = 2, ncol = 2)
  for (i in 1:2) {
    for (j in 1:2) {
      expected_matrix[i, j] <- (row_sums[i] * col_sums[j]) / total_sum
    }
  }
  
  return(expected_matrix)
}

# è¾“å…¥ä¸€ä¸ª2x2çš„è§‚æµ‹é¢‘æ•°çŸ©é˜µ
observed_matrix <- matrix(c(13, 7, 4987, 9993), nrow = 2)

# è°ƒç”¨å‡½æ•°è®¡ç®—ç†è®ºé¢‘æ•°çŸ©é˜µ
expected_matrix <- calculate_expected_frequencies(observed_matrix)

# è¾“å‡ºç†è®ºé¢‘æ•°çŸ©é˜µ
print("è§‚æµ‹é¢‘æ•°çŸ©é˜µï¼š")
print(observed_matrix)
print("ç†è®ºé¢‘æ•°çŸ©é˜µï¼š")
print(expected_matrix)

chisq.test(observed_matrix, correct = FALSE)
```

## ç§©æ£€éªŒ
### ç¬¦å·æ£€éªŒ
```{r}
# H0ï¼šAå’ŒBä¸€æ ·å¥½ï¼ŒH1ï¼šAå’ŒBæœ‰å·®å¼‚â†’ç»Ÿè®¡Aæ¯”Bå¥½çš„æ•°ç›®m
n = 200
m = 72
p = 0.3
a = 0.05
binom.test(m,n,p,alternative="two.sided", conf.level = 1-a)

# H0:Aä¸ä¼˜äºBï¼ŒH1ï¼šAä¼˜äºBâ†’ç»Ÿè®¡Aæ¯”Bå¥½çš„æ•°ç›®m
n = 200 # æ€»æ¬¡æ•°
m = 72 #æˆåŠŸæ¬¡æ•°
a = 0.05
p = 0.3
binom.test(m,n, p=0.3,alternative = "greater", conf.level = 1-a) # alternative = "greater"â†’Aå¤§äºB
```

### é…å¯¹ç¬¦å·æ£€éªŒ
åªçœ‹Aä¸Bçš„å·®å¼‚çš„æœ‰æ— ï¼Œä¸çœ‹å·®å¼‚çš„å…·ä½“å¤§å°
```{r}
# H0ï¼šä¸¤ä¸ªæ€»ä½“åˆ†å¸ƒç›¸åŒ
# å°æ ·æœ¬
data = c(1,0,0,0,0,0,0)
n_pos = sum(data)
n = 7 # ç›¸ç­‰ç»„å‰”é™¤
p = 0.5
p_value = 0
i = 0
while(i<=n_pos){
  p_value = p_value+choose(n,i)*(p)^i*(1-p)^(n-i)
  i = i+1
}
p_value
# å¤§æ ·æœ¬ç¤ºä¾‹
a = 0.05
(n_pos-n/2)/sqrt(n/4)#Uç»Ÿè®¡é‡
-qnorm(a/2)
qnorm(a/2)


# åˆ«å¬ä¸Šé¢çš„äº†ï¼Œä¸å¦‚ç”¨wilcoxåš
before <- c(65, 70, 68, 72, 67, 69, 71, 70, 66, 68)
after <- c(68, 69, 67, 75, 65, 70, 72, 70, 67, 68)
wilcox.test(before, after, paired = TRUE)# è¿™é‡Œæ˜¯é…å¯¹çš„å…³é”®
```

### åˆ†ä½æ•°ç‚¹çš„ç¬¦å·æ£€éªŒ

### å•ç»„æ ·æœ¬çš„ç¬¦å·ç§©æ£€éªŒï¼ˆæœ‰å¦ä¸€ç»„å‡å€¼/ä¸­ä½æ•°ï¼‰
wilcox.test å„å‚æ•°çš„é»˜è®¤å€¼ï¼š
alternative= 'two.sided', mu=0, paired= F, exact= NULL, correct= T,conf.level= 0.95
```{r}
data = c(44.21,45.30,46.39,49.47,51.05,53.16,53.26,54.37,57.16,67.37,71.05,87.37)
# ç›®æµ‹æ˜¯å¦ä¸ºæ­£æ€
density = density(data)
plot(density)
hist(data)

# ç›®æµ‹ä¸æ˜¯æ­£æ€
wilcox.test(data,mu = 45.30, alternative = "greater")
```

### é…å¯¹ç¬¦å·ç§©æ£€éªŒ
+ æ±‚ç§©
```{r}
data = c(3,6,2,4,7,8,1,3,5)
rank(data, na.last = TRUE, ties.method = "average")
# na.last = TRUEï¼šå¿½ç•¥ç¼ºå¤±å€¼ï¼›ties.method = "average"ï¼šç”¨å¹³å‡æ•°å¤„ç†ç›¸åŒå€¼

# æ ‡å‡†åŒ–
zscores = (data - mean(data))/var(data)
```

```{r}
# H0ï¼šä¸¤ä¸ªæ€»ä½“åˆ†å¸ƒç›¸åŒ
# å°æ ·æœ¬n<=50
data1 = c(0.75,0.59,0.73,0.68,0.58,0.86)
data2 = c(0.72,0.66,0.74,0.84,0.65,0.85)
wilcox.test(data1,data2,paired = TRUE,alternative = "two.sided")

# å¤§æ ·æœ¬n>50

```

### ä¸¤ä¸ªç‹¬ç«‹æ ·æœ¬çš„ç§©å’Œæ£€éªŒ
```{r}
# H0ï¼šå¥åº·ç”·æ€§è¡€æ¶²ä¸­çš„MYCåŸºå› è¡¨è¾¾å€¼ç­‰åŒäºè‚ç™Œç”·æ€§
# H1ï¼šå¥åº·ç”·æ€§è¡€æ¶²ä¸­çš„MYCåŸºå› è¡¨è¾¾å€¼ä½äºè‚ç™Œç”·æ€§

x <- c(23.6,20.9,29.8,11.8,23.0,24.1,17.6,27.6,32.8,27.5)
y <- c(21.9,12.5,7.3,11.7,12.1,11.5,9.5,9.6,10.5,10.2)
wilcox.test(x, y, alternative = "less")

# Wçš„è®¡ç®—
z <- c(x,y)
m <-length(x)
W=sum(rank(z)[1:m])-m*(m+1)/2
```

# æ–¹å·®åˆ†æ
## å•å› ç´ æ–¹å·®åˆ†æ
### å‡è®¾
åŸå‡è®¾H0ï¼šÎ¼1=Î¼2=Î¼3=â€¦â€¦=Î¼n
å¤‡æ‹©å‡è®¾H1ï¼šå­˜åœ¨Î¼iï¼Œä¸å…¶ä»–ç»„çš„å‡å€¼ä¸ç­‰
æ‹’ç»åŸå‡è®¾çš„æ„ä¹‰ï¼šæœ‰è¶³å¤Ÿè¯æ®è¡¨æ˜è‡³å°‘æœ‰ä¸€ä¸ªç»„çš„å‡å€¼ä¸å…¶ä»–ç»„çš„å‡å€¼å­˜åœ¨æ˜¾è‘—å·®å¼‚

### Få€¼
Få€¼æ˜¯ç”¨äºæ£€éªŒä¸åŒç»„ä¹‹é—´å‡å€¼å·®å¼‚æ˜¾è‘—æ€§çš„ä¸€ä¸ªç»Ÿè®¡é‡ã€‚å®ƒæ˜¯ç»„é—´å‡æ–¹ï¼ˆMSBï¼‰ä¸ç»„å†…å‡æ–¹ï¼ˆMSWï¼‰çš„æ¯”å€¼
  + åˆ†å­æ˜¯ç»„é—´å‡æ–¹ï¼ˆMSBï¼‰ï¼Œå³ä¸åŒç»„ä¹‹é—´çš„å˜å¼‚ç¨‹åº¦ã€‚å®ƒåæ˜ äº†ä¸åŒç»„çš„å‡å€¼ä¹‹é—´çš„å·®å¼‚ã€‚
  + åˆ†æ¯æ˜¯ç»„å†…å‡æ–¹ï¼ˆMSWï¼‰ï¼Œå³æ¯ç»„å†…éƒ¨æ•°æ®çš„å˜å¼‚ç¨‹åº¦ã€‚å®ƒåæ˜ äº†éšæœºè¯¯å·®çš„å¤§å°ã€‚

å¦‚æœç»„é—´å·®å¼‚æ˜¾è‘—ï¼Œåˆ™ç»„é—´å‡æ–¹ä¼šè¿œå¤§äºç»„å†…å‡æ–¹ï¼Œå¯¼è‡´Få€¼è¾ƒå¤§ã€‚ç›¸åï¼Œå¦‚æœç»„é—´å·®å¼‚è¾ƒå°æˆ–ä¸å­˜åœ¨ï¼Œåˆ™Få€¼æ¥è¿‘1

Få€¼è¶Šå¤§ï¼Œè¶Šæœ‰å¯èƒ½æ‹’ç»åŸå‡è®¾ï¼Œå³è®¤ä¸ºä¸åŒç»„çš„å‡å€¼å­˜åœ¨æ˜¾è‘—å·®å¼‚ã€‚é€šå¸¸ï¼Œå°†è®¡ç®—å¾—åˆ°çš„Få€¼ä¸ä¸´ç•Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œæˆ–è€…é€šè¿‡på€¼æ¥åˆ¤æ–­æ˜¯å¦æ‹’ç»åŸå‡è®¾ã€‚å¦‚æœFå€¼å¤§äºä¸´ç•Œå€¼æˆ–på€¼å°äºæ˜¾è‘—æ€§æ°´å¹³ï¼ˆå¦‚0.05ï¼‰ï¼Œåˆ™æ‹’ç»åŸå‡è®¾

### å…·ä½“æ“ä½œ
+ æ•´ä½“æ£€éªŒ å¿…é¡»æ˜¯æ­£æ€ã€ç‹¬ç«‹ã€é½æ€§æ ·æœ¬
  + æ­£æ€æ€§æ£€éªŒ
```{r}
data = c(1,2,3,4,5)
shapiro.test(data)# æ£€æµ‹æ˜¯å¦æ­£æ€
ks.test(data, "pnorm", mean = mean(data), sd = sd(data))# å¯ä»¥æ£€æµ‹å¤šç§åˆ†å¸ƒ
```

  + é½æ€§æ£€éªŒï¼šå„ç»„æ ·æœ¬é‡ç›¸ç­‰ï¼Œå¯ä»¥ä¸æ£€éªŒæ–¹å·®é½æ€§ 
```{r}
method_A <- c(200,220,210,230,190)
method_B <- c(240,250,230,260,220)
method_C <- c(180,190,170,200,195)
data = c(method_A,method_B,method_C)
method_type <- factor(rep(c("A", "B", "C"), each = 5))
df <- data.frame(weight_gain = data, method_type = method_type)

bartlett.test(weight_gain~ method_type, data = df)# æ­£æ€æ•°æ®

library(car)
leveneTest(weight_gain ~ method_type, data = df)# ä¸éœ€è¦æ•°æ®æ­£æ€
```

+ æ–¹å·®åˆ†æï¼š`aov()`å‡½æ•°
aov(formula, data=NULL, projections=FALSE, qr=TRUE,
contrasts=NULL, ...)
å…¶ä¸­ï¼Œformulaä¸ºæ–¹å·®åˆ†æå…¬å¼ï¼›dataä¸ºæ•°æ®æ¡†ï¼›projectionè®¾ç½®æ˜¯å¦è¿”å›é¢„æµ‹ç»“æœï¼›qrè®¾ç½®æ˜¯å¦è¿”å›QRåˆ†è§£ç»“æœï¼›contrastsä¸ºå…¬å¼ä¸­ä¸€äº›å› å­çš„åˆ—è¡¨ã€‚

  + å…¬å¼çš„è¡¨ç¤º
  
  |ç¬¦å·|ç”¨æ³•|
  |---|---|
  |~|åˆ†éš”ç¬¦å·ï¼Œå·¦è¾¹ä¸ºå“åº”ï¼ˆ/å› ï¼‰å˜é‡ï¼Œå³è¾¹ä¸ºè§£é‡Šï¼ˆ/è‡ªï¼‰å˜é‡egï¼šy~A+B+C|
  |+|åˆ†éš”è§£é‡Šå˜é‡|
  |:|è¡¨ç¤ºå˜é‡çš„äº¤äº’é¡¹egï¼šy~A+B+A:B|
  |\*|è¡¨ç¤ºæ‰€æœ‰å¯èƒ½äº¤äº’é¡¹egï¼šy~A\*B\*Cå¯å±•å¼€ä¸ºï¼šy~A+B+C+A:B+A:C+B:C+A:B:C|
  |^|è¡¨ç¤ºäº¤äº’é¡¹è¾¾åˆ°æ¬¡æ•°egï¼šy~(A+B+C)^2å±•å¼€ä¸ºï¼šy~A+B+C+A:B+A:C+B:C|
  |.|è¡¨ç¤ºåŒ…å«é™¤å› å˜é‡å¤–çš„æ‰€æœ‰å˜é‡egï¼šè‹¥ä¸€ä¸ªæ•°æ®æ¡†åŒ…æ‹¬å˜é‡y,Aã€Bå’ŒCï¼Œä»£ç y~.å¯å±•å¼€ä¸ºy~A+B+C|

  + å¸¸ç”¨è¡¨è¾¾å¼
  å•å› ç´ ï¼šy~A
  åŒå› ç´ ï¼šy~A*B

  + ç”¨å·²æœ‰æ•°æ®é›†
```{r}
data(iris)  #å¯¼å…¥Rè‡ªå¸¦çš„Irisæ•°æ®
library("dplyr"); iris %>% group_by(Species) %>% summarize(sw_mean=mean(Sepal.Width), sw_sd = sd(Sepal.Width))
# æ­£æ€æ€§æ£€éªŒ
shapiro.test(iris$Sepal.Width[iris$Species=='setosa'])
shapiro.test(iris$Sepal.Width[iris$Species=='versicolor'])
shapiro.test(iris$Sepal.Width[iris$Species=='virginica'])

#æ–¹å·®é½æ€§æ£€éªŒ
bartlett.test(Sepal.Width~Species,data=iris)

aov1 <- aov(Sepal.Length~Species, iris) # Speciesâ€œå› ç´ â€ï¼ŒLengthæ˜¯ç»“æœå˜é‡
aov1
summary(aov1)

# æå–ç²¾ç¡®På€¼
ann<-anova(aov1)
ann[["Pr(>F)"]][1]

#ä¸åŒå› ç´ æ°´å¹³ä¸¤ä¸¤æ¯”è¾ƒå¯ä»¥é‡‡ç”¨Tukey Honest Significant Differences (TukeyHSD) ç»Ÿè®¡æ–¹æ³•ï¼š
TukeyHSD(aov1)
```

  + ç”¨è‡ªå»ºæ•°æ®
```{r}
# è¾“å…¥æ•°æ®ï¼šæŒ‰è‡ªå˜é‡ä¸ºç»„åˆ«
method_A <- c(78,82,75,80,85)
method_B <- c(85,88,83,90,87)
method_C <- c(70,72,68,75,73)
method_D <- c(88,92,86,90,89)

# å°†æ•°æ®åˆå¹¶æˆä¸€ä¸ªå‘é‡ï¼Œå¹¶åˆ›å»ºå¯¹åº”çš„å› ç´ å˜é‡
data <- c(method_A,method_B,method_C,method_D)
methods_type <- factor(rep(c("A", "B", "C","D"), each = 5))

# è¿›è¡Œå•å› ç´ æ–¹å·®åˆ†æ
result <- aov(data ~ methods_type)
summary(result)
```

- è®¡ç®—SSAã€SSEã€Få€¼å’Œpå€¼ï¼Œç»™æ¯ç»„æ•°æ®
```{r}
method_A <- c(200,220,210,230,190)
method_B <- c(240,250,230,260,220)
method_C <- c(180,190,170,200,195)

n = 3 # ç»„æ•°
m = 5 # æ¯ç»„çš„æ ·æœ¬æ•°
# æœ‰æ ·æœ¬å…·ä½“æ•°å€¼
data = c(method_A,method_B,method_C)
mean_list = c(mean(method_A),mean(method_B),mean(method_C))
mean = mean(data)
var_list = c(var(method_A),var(method_B),var(method_C))

# åªæœ‰æ ·æœ¬å¹³å‡æ•°ä¸æ–¹å·®
mean_list = c(33.62,37.83,35.10,34.37)
var_list = c(5.12,4.87,10.98,7.08)
mean = mean(mean_list)
n = 4
m = 10

SSA = m*sum((mean_list-mean)^2)# æ¯ç»„æ ·æœ¬æ•°ä¸ä¸€æ ·çš„è¯ï¼Œmi*å¯¹åº”çš„ç»„æ–¹å·®
SSE = (m-1)*(sum(var_list))# æ¯ç»„æ ·æœ¬æ•°ä¸ä¸€æ ·çš„è¯ï¼Œï¼ˆmi-1ï¼‰*å¯¹åº”çš„ç»„æ–¹å·®
N = m*n
F_value = SSA*(N-n)/(SSE*(n-1))
pF = pf(F_value,df1 = n-1,df2 = N-n,lower.tail = FALSE) # ç”Ÿæˆçš„på€¼æ˜¯å•è¾¹æ£€éªŒçš„
df_A = n-1
df_E = N-n
MSA = SSA/df_A
MSE = SSE/df_E
data.frame(SSA,df_A,MSA,SSE,df_E,MSE,F_value,pF)
```

- è®¡ç®—SSAã€SSEã€Få€¼å’Œpå€¼ï¼Œç»™æ¯ç»„å‡å€¼
```{r}
n = 3 # ç»„æ•°
m = 5 # æ¯ç»„çš„æ ·æœ¬æ•°
mean_A = 1
mean_B = 2
mean_C = 3
s = 10
s_1 = 13
s_2 = 12
s_3 = 11
mean_list = c(mean_A,mean_B,mean_C)
mean = mean(m*(mean_A+mean_B+mean_C))

SSA = m*sum((mean_list-mean)^2)# æ¯ç»„æ ·æœ¬æ•°ä¸ä¸€æ ·çš„è¯ï¼Œmi*å¯¹åº”çš„ç»„æ–¹å·®
SST = (m*n-1)*s
SSE = (m-1)*(s_1+s_2+s_3)# æ¯ç»„æ ·æœ¬æ•°ä¸ä¸€æ ·çš„è¯ï¼Œï¼ˆmi-1ï¼‰*å¯¹åº”çš„ç»„æ–¹å·®
F_value = SSA*(m*n - n)/(SSE*(n-1))
pF = pf(F_value,df1 = n - 1,df2 = m*n - n,lower.tail = FALSE) # ç”Ÿæˆçš„på€¼æ˜¯å•è¾¹æ£€éªŒçš„
df_A = n - 1
df_E = m*n - n
MSA = SSA/df_A
MSE = SSE/df_E
data.frame(SSA,df_A,MSA,SSE,df_E,MSE,F_value,pF)
```

- æ–¹å·®ä¸é½/æ•°æ®ä¸æ­£æ€æ—¶ï¼šKWæ£€éªŒâ†’wilcoxæ£€éªŒçš„æ¨å¹¿
  - `kruskal.test()`å‡½æ•°
```{r}
# åˆ›å»ºæ•°æ®
yield_A <- c(20, 23, 25, 27, 30)
yield_B <- c(18, 20, 19, 22, 23)
yield_C <- c(28, 30, 32, 35, 38)
# åˆå¹¶æ•°æ®
yield <- c(yield_A, yield_B, yield_C)
# åˆ›å»ºç»„åˆ«å‘é‡
group <- factor(rep(c("A", "B", "C"), each = 5))# each = 5è¡¨ç¤ºæ¯ä¸ªç»„åˆ«æœ‰5ä¸ªæ•°æ®
# è¿›è¡ŒKWæ£€éªŒ
result <- kruskal.test(yield ~ group)
print(result)
# ç»˜åˆ¶ç®±çº¿å›¾
boxplot(yield ~ group, main = "ä¸åŒè‚¥æ–™å¯¹ä½œç‰©äº§é‡çš„å½±å“", xlab = "è‚¥æ–™ç»„åˆ«", ylab = "äº§é‡")
```

  - æŒ‰æ•°å­¦æ–¹æ³•è®¡ç®—
```{r}
n = 3
m = 5
N = n*m
yield_A <- c(20, 23, 25, 27, 30)
yield_B <- c(18, 20, 19, 22, 23)
yield_C <- c(28, 30, 32, 35, 38)
yield <- rank(c(yield_A, yield_B, yield_C))

R_A =  sum(yield[1:5])
R_B = sum(yield[6:10])
R_C = sum(yield[11:15])
list = c(R_A/m,R_B/m,R_C/m)

H = 12/(N*(N+1))*sum(m*(list-(N+1)/2)^2)
p_value = pchisq(H,df = n-1, lower.tail = FALSE)
data.frame(H,p_value)
```

  - å±€éƒ¨åˆ†æï¼šä¸¤ä¸¤tæ£€éªŒâ†’çŸ«æ­£på€¼ï¼ˆå…‹æœIç±»é”™è¯¯è†¨èƒ€ï¼‰
```{r}
# åˆ›å»ºæ•°æ®
yield_A <- c(20, 23, 25, 27, 30)
yield_B <- c(18, 20, 19, 22, 23)
yield_C <- c(28, 30, 32, 35, 38)
# åˆå¹¶æ•°æ®
yield <- c(yield_A, yield_B, yield_C)
# åˆ›å»ºç»„åˆ«å‘é‡
group <- factor(rep(c("A", "B", "C"), each = 5))# each = 5è¡¨ç¤ºæ¯ä¸ªç»„åˆ«æœ‰5ä¸ªæ•°æ®
# è¿›è¡ŒKWæ£€éªŒ
result <- kruskal.test(yield ~ group)
print(result)
pairwise.t.test(x = yield, g=group, p.adjust.method = "bonferroni", alternative = "two.sided")
```

## åŒå› ç´ æ–¹å·®åˆ†æ
```{r}
data("ToothGrowth")
str(ToothGrowth)
ToothGrowth$dose <-as.factor(ToothGrowth$dose)
ToothGrowth %>% group_by(supp,dose) %>% summarize(tlen=mean(len),tsd=sd(len))

# æ­£æ€æ€§æ£€éªŒ
shapiro.test(ToothGrowth$len[ToothGrowth$supp=='VC'])
shapiro.test(ToothGrowth$len[ToothGrowth$supp=='OJ'])
shapiro.test(ToothGrowth$len[ToothGrowth$dose==0.5])
shapiro.test(ToothGrowth$len[ToothGrowth$dose==1.0])
shapiro.test(ToothGrowth$len[ToothGrowth$dose==2.0])

# æ–¹å·®é½æ€§æ£€éªŒ
bartlett.test(len~supp, data=ToothGrowth)
bartlett.test(len~dose, data=ToothGrowth)

# æ–¹å·®åˆ†æ
an1<-aov(len~dose+supp,data=ToothGrowth)
summary(an1)

# å¯¹è¯¥å•å› ç´ è¯•éªŒè¿›è¡Œæ–¹å·®åˆ†æï¼šè·å–På€¼
ann1<-anova(an1)
ann1[["Pr(>F)"]][1]

# å› ç´ çš„äº¤äº’ä½œç”¨ï¼šä¸¤å› ç´ æ˜¯å¦ç‹¬ç«‹
an2<-aov(len~dose+supp+dose:supp, data=ToothGrowth)
ann2<-anova(an2)
ann2[["Pr(>F)"]][1]# åé¢æ‹¬å·é‡Œæ˜¯ç¬¬1æˆ–2å› ç´ çš„på€¼

# å› ç´ äº’ä½œçš„æ˜¾è‘—æ€§ï¼šç”¨Tukey Honest Significant 
TukeyHSD(an2,which="dose:supp")
```

# éå‚æ•°KWæ£€éªŒ
```{r}
# H0ï¼šå››ç§æ–¹æ³•æ•ˆæœæ— å·®åˆ«ï¼ŒH1ï¼šå››ç§æ–¹æ³•æ•ˆæœæœ‰å·®åˆ«
mydata_kw<-data.frame(
  ratio=c(1.6,1.7,1.9,1.9,2.0,
          1.5,1.6,1.6,1.7,2.0,
          1.4,1.6,1.6,1.7,1.9,
          1.1,1.1,1.2,1.3,1.6),
  group=c(rep("way1",5),
          rep("way2",5),
          rep("way3",5),
          rep("way4",5))
)
kruskal.test(ratio~group,data=mydata_kw)
```


# ç›¸å…³ä¸çº¿æ€§å›å½’
ç›¸å…³â‰ å› æœ
ä¸‰ä¸ªæ–¹æ³•ï¼šæ•£ç‚¹å›¾ã€ç›¸å…³ç³»æ•°ã€çº¿æ€§å›å½’æ¨¡å‹
## ç›¸å…³ç³»æ•°
+ ç›¸å…³ç³»æ•°ä¸å›å½’ç³»æ•°çš„å…³ç³»
  + ç›¸å…³ç³»æ•°
    + å®šä¹‰ï¼šè¡¡é‡ä¸¤ä¸ªå˜é‡ä¹‹é—´çº¿æ€§å…³ç³»çš„å¼ºåº¦å’Œæ–¹å‘ã€‚
    + å–å€¼èŒƒå›´ï¼šä»‹äº -1 å’Œ 1 ä¹‹é—´ã€‚æ­£ç›¸å…³è¡¨ç¤ºä¸€ä¸ªå˜é‡å¢åŠ ï¼Œå¦ä¸€ä¸ªå˜é‡ä¹Ÿå€¾å‘äºå¢åŠ ï¼›è´Ÿç›¸å…³åˆ™ç›¸åã€‚
    + æ— é‡çº²ï¼šç›¸å…³ç³»æ•°æ²¡æœ‰å•ä½ï¼Œä¾¿äºæ¯”è¾ƒä¸åŒæ•°æ®é›†ä¹‹é—´çš„å…³ç³»å¼ºåº¦ã€‚
    
  + å›å½’ç³»æ•°
    + å®šä¹‰ï¼šåœ¨å›å½’åˆ†æä¸­ï¼Œå›å½’ç³»æ•°è¡¨ç¤ºè‡ªå˜é‡æ¯å˜åŒ–ä¸€ä¸ªå•ä½ï¼Œå› å˜é‡çš„å¹³å‡å˜åŒ–é‡ã€‚
    + æœ‰é‡çº²ï¼šå›å½’ç³»æ•°çš„å•ä½æ˜¯å› å˜é‡çš„å•ä½é™¤ä»¥è‡ªå˜é‡çš„å•ä½ï¼Œåæ˜ äº†å˜é‡ä¹‹é—´çš„å®é™…å˜åŒ–å…³ç³»ã€‚
  
  + äºŒè€…å…³ç³»ï¼šç›¸å…³ç³»æ•°æ˜¯æ ‡å‡†åŒ–çš„å›å½’ç³»æ•°
  $ç›¸å…³ç³»æ•°r = å›å½’ç³»æ•°b*\frac{s_x}{s_y}$
    
### çš®å°”é€Šç›¸å…³ç³»æ•°Ï
è¡¡é‡çš„æ˜¯ä¸¤ä¸ªå˜é‡ä¹‹é—´çš„çº¿æ€§å…³ç³»å¼ºåº¦å’Œæ–¹å‘
+ å–å€¼èŒƒå›´ï¼šåœ¨-1åˆ°1ä¹‹é—´
+ é€‚ç”¨èŒƒå›´ï¼šåªèƒ½ç”¨äºæ»¡è¶³äºŒå…ƒæ­£æ€åˆ†å¸ƒçš„è¿ç»­å˜é‡ã€æ•°æ®æ¯”è¾ƒæµç•…ï¼ˆå¯¹æç«¯å€¼æ•æ„Ÿï¼‰
#### è®¡ç®—Ï
```{r}
x = c(1,2,3,4)
y = c(2,3,4,8)
n = length(x)
Ï = cor(x = x, y = y, use = "everything")# p = Cov(X*,Y*) = Cov(X,Y)/(Ïƒx*Ïƒy) = E[(X-Î¼x)(Y-Î¼y)]/(Ïƒx*Ïƒy)
cov = cov(x, y)# åæ–¹å·®
lxy = sum(x*y)-n*mean(x)*mean(y)# lxyï¼ˆåˆ†å­ï¼‰
lxx = (n-1)*var(x)
lyy = (n-1)*var(y)
data.frame(Ï,cov,lxy,lxx,lyy)
```
æ³¨é‡Šï¼š
*Ïçš„ç»å¯¹å€¼å¤§å°ä¸ç›´çº¿çš„æ–œç‡å¤§å°æ— å…³*
ç›¸å…³ç³»æ•°åªæè¿°*çº¿æ€§ç›¸å…³*æ€§ï¼Œä¸èƒ½æè¿°éçº¿æ€§ç›¸å…³æ€§ï¼šPearsonç›¸å…³ç³»æ•°r=0åªè¯´æ˜ä¸¤ä¸ªå˜é‡ä¹‹é—´æ²¡æœ‰çº¿æ€§å…³ç³»ï¼Œä½†å¯èƒ½å­˜åœ¨å…¶ä»–ç±»å‹çš„å…³ç³»ï¼ˆå¦‚éçº¿æ€§å…³ç³»ï¼‰

#### å‡è®¾æ£€éªŒ
H0ï¼šÏ=0ï¼ˆçº¿æ€§ä¸ç›¸å…³ï¼‰ï¼ŒH1ï¼šÏâ‰ 0ï¼ˆçº¿æ€§ç›¸å…³ï¼‰
ç»Ÿè®¡é‡T = (r-Ï)/sqrt((1-r^2)/(n-2))æœä»t(n-2)
```{r}
x = c(6,9,12,15,18)
y = c(12,17,22,25,29)
a = 0.05
cor.test(x, y, alternative = "two.sided", method = "pearson", conf.level = a)
# p<0.05ï¼Œåˆ™æ‹’ç»H0ï¼Œå³Ïâ‰ 0ï¼Œä¸¤æ ·æœ¬ç›¸å…³
```

#### æˆå¯¹på€¼è®¡ç®—
```{r}
library(Hmisc)
rcorr(as.matrix(iris[,1:4]),type="pearson")$r # è¿”å›ç³»æ•°çŸ©é˜µ
rcorr(as.matrix(iris[,1:4]),type="pearson")$P # è¿”å›på€¼
```


### æ–¯çš®å°”æ›¼spearmanç§©ç›¸å…³ç³»æ•°
æŠŠæ•°æ®çš„ç§©æ‹¿å‡ºæ¥ç®—ä¸€ä¸‹çš®å°”é€Šç›¸å…³ç³»æ•°
é€‚ç”¨èŒƒå›´ï¼šæœ‰ç¦»ç¾¤ç‚¹çš„æ•°æ®ï¼›ç›¸æ¯”çš®å°”é€Šï¼Œæœ‰ä¸€ç‚¹å¤„ç†éçº¿æ€§çš„èƒ½åŠ›
```{r}
x = c(1,2,3,4)
y = c(2,3,4,8)
n = length(x)
cor(x = x, y = y, use = "everything", method = "spearman")
cor.test(x, y, method = "spearman")
```

### kendall-Ï„ç›¸å…³ç³»æ•°
é€‚ç”¨èŒƒå›´ï¼šéçº¿æ€§æ•°æ®
å¤„ç†éçº¿æ€§æ•°æ®çš„èƒ½åŠ›æœ€å¼ºï¼Œä¹Ÿèƒ½å¤„ç†çº¿æ€§æ•°æ®ï¼Œä½†æ˜¯æ•ˆç‡æ¯”è¾ƒä½
```{r}
x = c(1,2,3,4)
y = c(2,3,4,8)
n = length(x)
cor(x = x, y = y, use = "everything", method = "kendall")
cor.test(x, y, method = "kendall")
```

## çº¿æ€§å›å½’æ¨¡å‹
+ æ¨¡å‹çš„å‡è®¾LINEï¼š
  + Lçº¿æ€§æ€§ï¼šXä¸Yä¹‹é—´çº¿æ€§å…³ç³»
  + Iç‹¬ç«‹æ€§ï¼šæ¯ä¸ªæ ·æœ¬(Xi,Yi)ä¹‹é—´ç‹¬ç«‹
  + Næ­£æ€æ€§ï¼šè¯¯å·®æœä»æ­£æ€åˆ†å¸ƒï¼Œå‡å€¼ä¸º0
  + Eæ–¹å·®é½æ€§ï¼šä¸åŒXå€¼å¯¹åº”çš„è¯¯å·®æ–¹å·®ç›¸åŒï¼ˆÎµ~N(0,Ïƒ^2)ï¼‰
+ æœ€å°äºŒä¹˜ï¼šç‚¹åˆ°ç›´çº¿çš„è·ç¦»ï¼ˆå‚ç›´äºxè½´ï¼‰â€”â€”æ®‹å·®å¹³æ–¹å’Œ
```{r}
x = c(0.5,0.5,0.5,1.0,1.0,1.0,1.5,1.5,1.5)
y = c(55,61,62,90,95,103,132,129,145)
df = data.frame(x,y)
model = lm(y~x,data = df)# coefficientséƒ¨åˆ†ï¼šinterceptæ˜¯æˆªè·ï¼Œxæ˜¯ç³»æ•°ï¼Œtæ˜¯æ£€éªŒç³»æ•°æ˜¯å¦æ˜¾è‘—ä¸ä¸º0
# residual standard errorï¼šsqrt(Q/(n-2))â€”â€”Qä¸ºæ®‹å·®å¹³æ–¹å’Œ
summary(model)
model = lm(x~y,data = df)
summary(model)

# æ‰‹åŠ¨è®¡ç®—
lxy = sum((x-mean(x))*(y-mean(y)))
lxx = sum((x-mean(x))^2)
k = lxy/lxx
b = mean(y)-k*mean(x)
sigma2 = sum((y-b-k*x)^2)/(n-2)# ç‰ºç‰²ä¸¤ä¸ªè‡ªç”±åº¦ï¼Œæ‰€ä»¥æ˜¯n-2
data.frame(lxy,lxx,k,b,sigma2)

# æ£€æŸ¥æ®‹å·®çš„æ­£æ€æ€§ï¼ˆQ-Q å›¾ï¼‰
shapiro.test(residuals(model))# p<0.05ï¼Œåˆ™ä¸æœä»æ­£æ€
qqnorm(residuals(model))
qqline(residuals(model))

# æ£€æŸ¥æ®‹å·®çš„æ–¹å·®é½æ€§
library(lmtest)
bptest(model)# p<0.05ï¼Œåˆ™æ–¹å·®ä¸é½æ€§
plot(fitted(model), residuals(model))
abline(h = 0, col = "red")

# æ£€æŸ¥æ®‹å·®çš„ç‹¬ç«‹æ€§
library(lmtest)
dwtest(model)# p<0.05ï¼Œåˆ™æ ·æœ¬é—´ä¸ç‹¬ç«‹

# ä½œå›¾
plot(model)

# é¢„æµ‹ï¼šçº¿æ€§é¢„æµ‹æœ‰å¯èƒ½å¾—åˆ°è´Ÿå€¼
new = data.frame(seq(3,6))
predict(model,new,interval = "confidence") # newåº”è¯¥æ˜¯dataframeï¼šx=data.frame(c(1,2,3))
```

### çº¿æ€§å›å½’çš„å‡è®¾æ£€éªŒï¼šå¯¹äºÎ²=0çš„åŸå‡è®¾
å•å› ç´ çš„çº¿æ€§å›å½’æ¨¡å‹ï¼štæ£€éªŒå’ŒFæ£€éªŒç­‰ä»·â€”â€”F=t^2
å¤šå› ç´ çš„çº¿æ€§å›å½’æ¨¡å‹ï¼š
  tæ£€éªŒï¼šH0ï¼šÎ²1 = 0ï¼ŒåŒè¾¹æ£€æµ‹
  Fæ£€éªŒï¼šH0ï¼šÎ²1 = Î²2 = Î²3 = 0ï¼Œå•è¾¹æ£€æµ‹

tæ£€éªŒç»Ÿè®¡é‡ï¼š![tæ£€éªŒç»Ÿè®¡é‡](D:/XCæ–‡ä»¶/ç¢çº¸æœº/å¤§å­¦/è¯¾ç¨‹/25.2-25.7 å¤§äºŒä¸‹/25.2-25.6 ç†å·¥ä¿¡ï¼ˆä¸Šï¼‰/Rscript/photos/Screenshot 2025-05-26 111257.png)

Fæ£€éªŒç»Ÿè®¡é‡ï¼š![Fæ£€éªŒç»Ÿè®¡é‡](D:/XCæ–‡ä»¶/ç¢çº¸æœº/å¤§å­¦/è¯¾ç¨‹/25.2-25.7 å¤§äºŒä¸‹/25.2-25.6 ç†å·¥ä¿¡ï¼ˆä¸Šï¼‰/Rscript/photos/Screenshot 2025-05-26 111521.png)
```{r}
x = c(1,2,3,4,5)
y = c(2,4,6,7,8)
n = length(x)

lxy = sum(x*y)-n*mean(x)*mean(y)
lxx = sum(x^2)-n*mean(x)^2
lyy = sum(y^2)-n*mean(y)^2

U = lxy^2/lxx
Q = lyy - lxy^2/lxx

beita_hat = lxy/lxx
beita = 0

sd_beita_hat = sqrt(Q/(n-2)) # è¿™ä¸ª2æ˜¯å˜é‡æ•°+1
se_beita_hat = sd_beita_hat*sqrt(1/sum((x-mean(x))^2))
t = (beita_hat - beita)/se_beita_hat
p = 2*pt(t,n-2,lower.tail = F)# è¿™é‡Œæœ‰ä¸ª2*
data.frame(lxx,lyy,lxy,U,Q,beita_hat,sd_beita_hat,se_beita_hat,t,p)
```

### å†³å®šç³»æ•°R^2
Xèƒ½è§£é‡Š Yå˜åŒ–çš„ç™¾åˆ†æ¯”ï¼Œè¶Šæ¥è¿‘äº1ï¼Œè¡¨ç¤ºå›å½’æ•ˆæœè¶Šå¥½
```{r}
x = c(1,2,3,4,5)
y = c(2,4,6,7,8)
n = length(x)

lxy = sum(x*y)-n*mean(x)*mean(y)
lxx = sum(x^2)-n*mean(x)^2
lyy = sum(y^2)-n*mean(y)^2

U = lxy^2/lxx
Q = lyy - lxy^2/lxx
R2 = U/lyy

r = cor(x = x, y = y, use = "everything")
# r ä¹Ÿå¯ä»¥è¿™ä¹ˆç®—ï¼š
r = b*sd(x)/sd(y)
# R2 = r^2
```

*åˆ¤æ–­çº¿æ€§å›å½’çš„æ‹Ÿåˆè´¨é‡ï¼ˆXä¸Yæ˜¯å¦ç›¸å…³ï¼‰ï¼šRSEè¶Šå°ï¼Œ`R^2`è¶Šæ¥è¿‘1ï¼Œæ‹Ÿåˆè¶Šå¥½*

## è¡¥å……å†…å®¹
### å¤šå…ƒçº¿æ€§å›å½’
```{r}
library(MASS)
model = lm(medv~lstat+age,data = Boston)
summary(model)
```

### éçº¿æ€§å›å½’
```{r}
library(MASS)
# å–å¹³æ–¹ï¼šä¸€èˆ¬ä¸åŠ å¹³æ–¹
lm.fit2 <- lm(medv ~ lstat + I(lstat^2),data = Boston)# Iï¼ˆx^2ï¼‰
summary(lm.fit2)
lstatlims=c(0,40)
lstatgrid=seq(0,40)
plot(Boston$lstat, Boston$medv, xlim = lstatlims, cex = .5, col = "darkgrey")
lines(lstatgrid, predict(lm.fit2, data.frame(lstat = lstatgrid)), col = "red", lwd = 2)

# å–log
 lm.fitlog <- lm(medv ~ log(lstat),data = Boston)# log
 summary(lm.fitlog)
 lstatlims=c(0,40)
 lstatgrid=seq(0,40)
 plot(Boston$lstat, Boston$medv, xlim = lstatlims, cex = .5, col = "darkgrey")
 lines(lstatgrid, predict(lm.fitlog, data.frame(lstat = lstatgrid)),    col = "red", lwd = 2)
 
 # å¤šé¡¹å¼å›å½’
 lm.fit3 <- lm(medv ~ poly(lstat, 3),Boston)# poly
 summary(lm.fit3)
 lstatlims=c(0,40)
 lstatgrid=seq(0,40)
 plot(Boston$lstat, Boston$medv, xlim = lstatlims, cex = .5, 
    col = "darkgrey")
 lines(lstatgrid, predict(lm.fit3, data.frame(lstat = lstatgrid)),    col = "red", lwd = 2)
```

### éå‚æ•°æ‹Ÿåˆ
ç¼ºç‚¹ï¼šé¢„æµ‹åªèƒ½åœ¨æœ‰æ•°æ®çš„è¿™ä¸€å—æ‹Ÿåˆ
#### å±€éƒ¨å›å½’
å±€éƒ¨å›å½’ä¸€ç§éå‚æ•°æ–¹æ³•ï¼Œå®ƒæŠŠæ ·æœ¬åˆ’åˆ†æˆå°åŒºé—´ï¼Œå¯¹åŒºé—´ä¸­çš„æ ·æœ¬è¿›è¡Œå¤šé¡¹å¼å›å½’ï¼Œå¾—åˆ°åœ¨ä¸åŒåŒºé—´çš„åŠ æƒå›å½’æ›²çº¿ï¼Œæœ€åå†æŠŠè¿™äº›å›å½’æ›²çº¿çš„ä¸­å¿ƒè¿åœ¨ä¸€èµ·åˆæˆå®Œæ•´çš„å›å½’æ›²çº¿ã€‚
```{r}
lstatxlims=c(1,40)
lstatgrid=seq(1,40)
fit <- loess(medv ~ lstat, data = Boston, span=0.2) 
plot(Boston$lstat, Boston$medv, xlim = lstatxlims, cex = .5, col = "darkgrey")
lines(lstatgrid, predict(fit, data.frame(lstat = lstatgrid)), col = "red", lwd = 2)
legend("topright", legend = c("Span = 0.2", "Span = 0.5"), col = c("red", "blue"), lty = 1, lwd = 2, cex = .8)

# é¢„æµ‹
results<-predict(fit, data.frame(lstat = c(20,30,35)), se = TRUE)
 points(c(20,30,35),results$fit, col = "green", lwd = 3)
```

#### é€»è¾‘å›å½’
Logisticå›å½’è™½ç„¶åå­—é‡Œå¸¦â€œå›å½’â€ï¼Œä½†ä¸»è¦ç”¨äºä¸¤åˆ†ç±»é—®é¢˜ï¼ˆå³è¾“å‡ºåªæœ‰ä¸¤ç§ï¼Œåˆ†åˆ«ä»£è¡¨ä¸¤ä¸ªç±»åˆ«ï¼‰
```{r}
y = c(0.1,0.2,0.3,0.4,0.5,0.6,0.7)
x1 = c(14,26,24,12,67,26,47)
x2 = c(12,46,23,56,35,12,13)
dataset = data.frame(x1,x2,y)
model = glm(y ~ x1+x2,family = "binomial", data = dataset)
summary(model)

# èƒ½ä¸èƒ½ç”¨è¿‡å»äº”å¤©çš„äº¤æ˜“æŠ•èµ„å›æŠ¥ç‡é¢„æµ‹ä»Šå¤©çš„æ¶¨è·Œï¼Ÿ
library(ISLR2)
attach(Smarket)
glm.fits <- glm(
  Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + Volume, data = Smarket, family = "binomial")
summary(glm.fits)
detach(Smarket)
```

### coxå›å½’
HRå¤§äº1æ˜¯ä¿æŠ¤ï¼ŒHRå°äº1æ˜¯ä¼¤å®³